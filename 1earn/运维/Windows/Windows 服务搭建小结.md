# Windows 小结

---

## 磁盘管理

**例1**

1. 新建两个10G的云硬盘，名称为A-10-1、A-10-2，挂载到云主机A；
2. 新建镜像卷，使用所有空间，驱动器号为D。

```markdown
1. 开始——管理工具——计算机管理——存储——磁盘管理
2. 把新建的磁盘1和2联机初始化
3. 右键磁盘1——建立镜像卷——指定2个磁盘——分配盘符——一路下一步
```

**例2**

1. 新建一个10G的云硬盘，名称为A-10-1，挂载到云主机A
2. 将该硬盘做如下配置：配置为动态磁盘，并创建一个普通卷，大小为10G，文件系统为NTFS，驱动器号为D。

```markdown
1. 开始——管理工具——计算机管理——存储——磁盘管理
2. 把新建的磁盘1联机初始化
3. 右键磁盘1——转换成动态磁盘——新建简单卷——分配盘符——一路下一步
```

**例3**

1. 新建三个10G的云硬盘，名称为A-10-1、A-10-2、A-10-3，挂载到云主机A；
2. 新建RAID-5卷，使用所有空间，驱动器号为D。

```markdown
1. 开始——管理工具——计算机管理——存储——磁盘管理
2. 把新建的磁盘1、2、3联机初始化
3. 右键磁盘1——建立RAID-5卷——指定3个磁盘——分配盘符——一路下一步
```

---

## DNS

**例1**

1. 配置abc.com域的从DNS服务，主DNS为云主机A。
2. 配置0.16.172反向域的从DNS服务，主DNS为云主机A。

```markdown
1. 服务器管理器——添加角色——DNS服务器
2. 服务器管理器——角色——DNS服务器
3. 正向查找区域——新建区域——辅助区域——abc.com——输入云主机A的IP
4. 反向查找区域——新建区域——辅助区域——172.16.0——输入云主机A的IP
```

**例2**

1. 将ftp.abc.com解析至云主机B公网IP；
2. 将www.abc.com解析至云主机A公网IP；
3. 建立反向简析区域完成 ftp.abc.com，www.abc.com，域名的反向解析；
4. 只允许云主机B 192.168.XX+1.33的ip进行区域传送。

```markdown
1. 服务器管理器——添加角色——DNS服务器
2. 服务器管理器——角色——DNS服务器
3. 正向查找区域——新建区域——主要区域——abc.com——一路下一步
4. abc.com——新建主机——略（记得勾选“创建相关的指针记录”）
5. 反向查找区域——新建区域——主要区域——172.16.0——一路下一步
6. abc.com——属性——区域传输——允许-只允许到下列服务器——192.168.XX+1.33
7. 0.16.172.in-addr.arpa——属性——区域传输——允许-只允许到下列服务器——192.168.XX+1.33
```

**例3**

1. 在Windows 2008 R2的DNS服务管理工具中添加四条主机记录，实现 vpn.abc.com，www.abc.com，web.abc.com，ftp.abc.com域名的解析（解析至HTTP 服务虚机IP）。并用 nslookup 验证；
2. 建立反向简析区域完成 vpn.abc.com，www.abc.com，web.abc.com，ftp.abc.com域名的反向解析，并用 nslookup 验证；

同上，略

---

## FTP

**例1**

1. FTP站点名称为abcftp，物理路径为D:\ftpdata；
2. 允许匿名用户和普通用户tom登录，匿名用户对主目录只有读权限，tom对主目录有读写权限，禁止上传exe后缀的文件；
3. 设置FTP最大客户端连接数为100，设置无任何操作的超时时间为5分钟，设置数据连接的超时时间为1分钟。

```markdown
1. 开始——管理工具——计算机管理——系统工具——本地用户和组——用户——新用户——tom
2. 服务器管理器——添加角色——web服务器——ftp服务器
3. 服务器管理器——角色——web服务器——IIS管理器——网站——添加FTP站点——指定名称，路径——指定IP地址—身份验证选择匿名和基本，授权选所有用户读取
4. abcftp——FTP授权规则——添加允许规则——指定用户tom——写入
5. abcftp——FTP请求筛选——拒绝文件扩展名——exe
6. abcftp——高级设置——最大连接数100——控制通道超时300——数据通道超时60
```

**例2**

1. 安装FTP服务，新建一个FTP站点，主目录为C:\ftproot，通过适当技术实现用户soft1与soft2通过匿名方式登录FTP站点时，只能浏览到“Public”子目录中的内容，若用个人账号登录FTP站点，则只能访问自己的子文件夹；
2.	设置FTP最大客户端连接数为100。设置无任何操作的超时时间为5分钟,设置数据连接的超时时间为1分钟；

```markdown
1. 开始——管理工具——计算机管理——系统工具——本地用户和组——用户——新用户——soft1
2. 新用户——soft2
3. 服务器管理器——添加角色——web服务器——ftp服务器
4. 服务器管理器——角色——web服务器——IIS管理器——网站——添加FTP站点——指定名称，路径——指定IP地址—身份验证选择匿名和基本，授权选所有用户读取
5. FTP站点——添加虚拟目录——public、soft1、soft2
6. FTP站点——public——FTP授权规则——删除默认加上去的允许所有用户——读取
7. FTP站点——public——FTP授权规则——添加允许规则——所有匿名用户——读取
8. FTP站点——soft1——FTP授权规则——删除默认加上去的允许所有用户——读取
9. FTP站点——soft1——FTP授权规则——添加允许规则——soft1——读取
10. FTP站点——soft2——FTP授权规则——删除默认加上去的允许所有用户——读取
11. FTP站点——soft2——FTP授权规则——添加允许规则——soft2——读取
12. FTP站点——高级设置——最大连接数100——控制通道超时300——数据通道超时60
```

**例3**

1.	FTP 需求说明
- 允许程序员tom通过ftp更新网站；
- 允许程序员jack通过ftp更新平台；
- 创建一个销售账户sale，用于通过FTP下载产品说明书。

2.	FTP服务的配置
- 创建三个用户tom、jack和sale，密码均为 123456
- 创建FTP站点，具体要求如下
- 设置FTP主目录为：D:\web\；
- 设置FTP主目录权限为：只允许tom、jack、sale和administrator用户访问FTP，但不允许对FTP根目录内容进行修改；
- 设置目录D:\web\cii_web的访问权限为：
- 仅允许用户tom和administrator读取和写入
- 设置目录D:\web\cloud的访问权限为：
- 仅允许用户jack和administrator读取和写入
- 创建目录D:\web\sale，并设置其访问权限为：
- 仅允许用户sale和administrator读取和写入

```markdown
1. 开始——管理工具——计算机管理——系统工具——本地用户和组——用户——新用户——tom
2. 新用户——jack
3. 新用户——sale
4. 服务器管理器——添加角色——web服务器——ftp服务器
5. 服务器管理器——角色——web服务器——IIS管理器——网站——添加FTP站点——指定名称，路径——指定IP地址—身份验证选择基本，授权选所有用户读取
6. FTP站点——添加虚拟目录——cii_web、cloud、sale
7. FTP站点——cii_web——FTP授权规则——删除默认加上去的允许所有用户——读取
8. FTP站点——cii_web——FTP授权规则——添加允许规则——tom——读取
9. FTP站点——cii_web——FTP授权规则——添加允许规则——administrator——读取
10. FTP站点——cloud——FTP授权规则——删除默认加上去的允许所有用户——读取
11. FTP站点——cloud——FTP授权规则——添加允许规则——jack——读取
12. FTP站点——cloud——FTP授权规则——添加允许规则——administrator——读取
13. FTP站点——sale——FTP授权规则——删除默认加上去的允许所有用户——读取
14. FTP站点——sale——FTP授权规则——添加允许规则——sale——读取
15. FTP站点——sale——FTP授权规则——添加允许规则——administrator——读取
```

---

## web服务

**例1**

- 站点名称为 abc.com
    - 在D:\webdata文件夹内中创建名称为index.html的主页，主页显示内容“fubuki!fubuki!fubuki!”
    - 配置站点https功能
    - 设置网站的最大连接数为1000，网站链接超时为60s，网站的带宽为1000kB/s
    - 使用W3C记录日志；每天创建一个新的日志文件，使用当地时间作为日志文件名

```markdown
1. 服务器管理器——添加角色——web服务器
2. 服务器管理器——角色——web服务器——IIS管理器——网站——添加网站——指定名称和路径，http,IP地址
3. 在linux中用openssl生成pfx证书文件，搞到win2008里来(自己想办法，步骤略)
4. 点击IIS管理器——WIN-xxxxxxxxxx主页(类似的那个东西)——服务器证书——右键导入pfx证书
5. abc.com——绑定——添加——https——选择导入的证书——无视报错信息——重启服务测试
6. abc.com——高级设置——最大并发连接数1000——连接超时60——最大带宽1000000
7. abc.com——日志——勾选使用本地时间进行文件命名和滚动更新
```

**例2**

1.	安装IIS组件，创建www.abc.com站点，在C:\MyShare文件夹内中创建名称为abc.html的主页，主页显示内容“fubuki!fubuki!fubuki!”；
2.	设置网站的最大连接数为1000，网站链接超时为60s，网站的带宽为1000kB/s，使用W3C记录日志；每天创建一个新的日志文件，使用当地时间作为日志文件名；日志只允许记录日期、时间、客户端IP地址、用户名、服务器IP地址、服务器端口号和方法；

```markdown
1. 服务器管理器——添加角色——web服务器
2. 服务器管理器——角色——web服务器——IIS管理器——网站——添加网站——指定名称和路径，http,IP地址
3. www.abc.com——高级设置——最大并发连接数1000——连接超时60——最大带宽1000000
4. www.abc.com——日志——选择字段——需要的勾不需要的不勾
5. www.abc.com——日志——勾选使用本地时间进行文件命名和滚动更新
```

**例3**

1.	安装IIS组件，创建www.abc.com站点，在C:\MyShare文件夹内中创建名称为abc.html的主页，主页显示内容“fubuki!fubuki!fubuki!”，同时只允许使用SSL且只能采用域名方式进行访问；
2.	设置网站的最大连接数为800，网站链接超时为30s，网站的带宽为2048kB/s，使用W3C记录日志；每天创建一个新的日志文件，使用当地时间作为日志文件名；日志只允许记录日期、时间、客户端IP地址、用户名、服务器IP地址、服务器端口号和方法；

```markdown
1. 服务器管理器——添加角色——web服务器
2. 服务器管理器——角色——web服务器——IIS管理器——网站——添加网站——指定名称和路径，http,IP地址
3. 在linux中用openssl生成pfx证书文件，搞到win2008里来(自己想办法，步骤略)
4. 点击IIS管理器——WIN-xxxxxxxxxx主页(类似的那个东西)——服务器证书——右键导入pfx证书
5. www.abc.com——绑定——添加——https——选择导入的证书——无视报错信息——重启服务测试
6. www.abc.com——SSL设置——要求SSL——接受
7. www.abc.com——高级设置——最大并发连接数800——连接超时30——最大带宽2048000
8. www.abc.com——日志——选择字段——需要的勾不需要的不勾
9. www.abc.com——日志——勾选使用本地时间进行文件命名和滚动更新
```

---

## CA证书

**例1**

1. 提供Web注册方式，可接受CSR（证书请求文件）并签发证书；
2. 加密服务提供程序为“RSA##Microsoft Software Key Storage Providew”，密钥字符长度为“2048”；
3. 颁发的签名证书的哈希算法为“SHA256”；
4. CA证书名称：ca.abc.com；
5. 为云主机B的web服务提供证书，颁发的证书命名为httpd.crt。

```markdown
1. linux生成csr文件传过来
2. 自己安装AD证书服务，详见https://www.cnblogs.com/zhongweiv/archive/2013/01/07/https.html
3. 访问 localhost/certsrv——申请证书——高级证书申请——  使用 base64 编码的 CMC 或 PKCS ##10 文件提交 一个证书申请，或使用 base64 编码的 PKCS ##7 文件续订证书申请——将csr文件的内容粘贴，选择提交
4. 服务器管理器——角色——AD证书服务——ca.abc.com——挂起的申请——颁发
5. 访问 localhost/certsrv——查看挂起的证书申请的状态——basic64编码——下载证书
6. 后缀cer改为crt
7. 把crt证书传给linux
```

---

## Windows server Backup

**例1**

1. 配置安装 Windows server Backup 服务，新建备份计划备份路径为 c:\windows\system32\dns. 备份时间为每日13点和0点。备份到 目标卷 D；

```markdown
1. 服务器管理器——添加功能——Windows server Backup
2. 服务器管理器——存储——Windows server Backup
3. 备份计划——自定义——选择文件夹——指定好时间——备份到专用于备份的硬盘——选择D盘
```

**例2**

1. 安装 Windows server Backup 服务，新建备份计划，备份路径为C:\ MyShare. 备份时间为每日15点，备份目标为另一台机器的 C:\backup\website，备份传输链路为第二张网卡。

```markdown
1. 服务器管理器——添加功能——Windows server Backup
2. 服务器管理器——存储——Windows server Backup
3. 备份计划——自定义——选择文件夹——指定好时间——备份到共享网络文件夹——路径为:\\公网IP\\backup\website
```

**例3**

1. 挂载一个云硬盘，具体要求如下：
2. 将该硬盘做如下配置：配置为动态磁盘，并创建一个普通卷，文件系统为NTFS，驱动器号为D。
3. 备份目录：D:\Backup\Cloud

```markdown
1. 服务器管理器——添加功能——Windows server Backup
2. 服务器管理器——存储——Windows server Backup
3. 备份计划——自定义——选择文件夹——高级设置——排除——添加排除——选择文件夹——.temp——指定好时间——备份到共享网络文件夹——路径为:\\IP\Backup\Cloud
4. 配置性能设置——本地磁盘D——增量备份
```

---

## 安全策略

**例1**

1. 配置安全策略，使得用户在登陆错误尝试3次之后锁定，锁定时间为5分钟，锁定间隔为2分钟 并记录登陆错误信息。

```markdown
1. 开始——管理工具——本地安全策略（或win+r 输入secpol.msc）
2. 账号策略——账户锁定策略——账户锁定阈值——3次
3. 账号策略——账户锁定策略——账户锁定时间——5分钟
4. 账号策略——账户锁定策略——重置账户锁定计数器——2分钟
5. 本地策略——审核策略——审核账号登陆事件——失败
```

**例2**

1. 新建用户 user1、user2、user3并限制user1的磁盘配额为100MB，警告等级为80M。user2 的配额为500M，user3 为不限制。

```markdown
1. 开始——管理工具——计算机管理——系统工具——本地用户和组——用户——新用户——user1
2. 新用户——user2
3. 新用户——user3
4. 右键磁盘——属性——配额——启动配额管理——配额项——配额——新建配额项
5. 剩下的略
```

---

## telnet

**例1**

1. 配置telnet服务

```markdown
1. 服务器管理器——添加功能——Telnet服务器
2. 开始——管理工具——服务——Telnet——手动——开启
```

---

## 文件共享

**例1**

1. 创建文件共享，共享目录为：C:\backup

```markdown
1. 右键 C:\backup——共享——高级共享——共享此文件夹
2. 右键 C:\backup——共享——共享——Administrator——共享
```
